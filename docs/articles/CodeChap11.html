<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapitre 11. Introduction aux séries temporelles. • sageR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Chapitre 11. Introduction aux séries temporelles.">
<meta property="og:description" content="sageR">
<meta property="og:image" content="https://fbertran.github.io/sageR/reference/figures/logo.png">
<meta property="og:image:alt" content="Statistiques pour l’économie et la gestion">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@BertrandFrdric2">
<meta name="twitter:site" content="@deboeck">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sageR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/AllLinksExtVignettes.html">Liens vers la vignette de chaque chapitre.</a>
    </li>
    <li>
      <a href="../articles/CodeChap01.html">Chapitre 01. Introduction à la statistique et à son environnement.</a>
    </li>
    <li>
      <a href="../articles/CodeChap02.html">Chapitre 02. Statistiques descriptives et visualisation des données univariables</a>
    </li>
    <li>
      <a href="../articles/CodeChap03.html">Chapitre 03.	Statistiques descriptives et visualisation des données bivariables ou multivariables</a>
    </li>
    <li>
      <a href="../articles/CodeChap04.html">Chapitre 04. Exploration de données avec l'analyse en composantes principales.</a>
    </li>
    <li>
      <a href="../articles/CodeChap05.html">Chapitre 05. Exploration de données avec l'analyse factorielle des correspondances.</a>
    </li>
    <li>
      <a href="../articles/CodeChap06.html">Chapitre 06. Exploration de données avec l'analyse des correspondances multiples.</a>
    </li>
    <li>
      <a href="../articles/CodeChap07.html">Chapitre 07. Exploration des données avec une classification automatique.</a>
    </li>
    <li>
      <a href="../articles/CodeChap08.html">Chapitre 08. Introduction à la théorie des probabilités aux distributions statistiques classiques.</a>
    </li>
    <li>
      <a href="../articles/CodeChap09.html">Chapitre 09. Inférence statistique.</a>
    </li>
    <li>
      <a href="../articles/CodeChap10.html">Chapitre 10. Modèle linéaire gaussien.</a>
    </li>
    <li>
      <a href="../articles/CodeChap11.html">Chapitre 11. Introduction aux séries temporelles.</a>
    </li>
    <li>
      <a href="../articles/CodeChap12.html">Chapitre 12. Introduction aux modèles logit et probit.</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fbertran/sageR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="CodeChap11_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapitre 11. Introduction aux séries temporelles.</h1>
            <h3 class="subtitle">Tout le code avec R.</h3>
                        <h4 class="author">Fredj Jawadi et Gilles Dufrenot</h4>
            
            <h4 class="date">2021-08-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/fbertran/sageR/blob/master/vignettes/CodeChap11.Rmd"><code>vignettes/CodeChap11.Rmd</code></a></small>
      <div class="hidden name"><code>CodeChap11.Rmd</code></div>

    </div>

    
    
<table class="table"><tr>
<td>
<img src="../man/figures/9782807319448-g.jpg" align="left" width="300" style="margin:0 100px 0 0;">
</td>
<td>
<img src="../man/figures/logo.png" align="right" width="200" style="margin:0 0 0 100px;">
</td>
</tr></table>
<div id="description-des-données-bitcoin" class="section level1">
<h1 class="hasAnchor">
<a href="#description-des-donn%C3%A9es-bitcoin" class="anchor"></a>Description des données : Bitcoin</h1>
<p>Lecture des données</p>
<p>Description de la base de données Bitcoin</p>
<p>Les données décrivent l’évolution du prix journalier du Bitcoin sur la période du <code>31/12/2014</code> au <code>15/05/2018</code>. Les données sont publiques et disponibles sur le site de Yahoo finance (<a href="https://fr.finance.yahoo.com/quote/BTC-EUR/history?p=BTC-EUR" class="uri">https://fr.finance.yahoo.com/quote/BTC-EUR/history?p=BTC-EUR</a>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"sageR"</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"sageR"</span><span class="op">)</span><span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/homepage/">sageR</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">bitcoin</span><span class="op">)</span></code></pre></div>
<p>Quelques statistiques descriptives du fichier de données</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bitcoin</span><span class="op">)</span>
<span class="co">#&gt;       Date                        Bitcoin       </span>
<span class="co">#&gt;  Min.   :2014-12-31 00:00:00   Min.   :  149.9  </span>
<span class="co">#&gt;  1st Qu.:2015-11-04 00:00:00   1st Qu.:  300.1  </span>
<span class="co">#&gt;  Median :2016-09-06 00:00:00   Median :  585.2  </span>
<span class="co">#&gt;  Mean   :2016-09-06 10:27:09   Mean   : 2125.1  </span>
<span class="co">#&gt;  3rd Qu.:2017-07-11 00:00:00   3rd Qu.: 2328.6  </span>
<span class="co">#&gt;  Max.   :2018-05-15 00:00:00   Max.   :16376.3</span></code></pre></div>
</div>
<div id="application-pratique--analyse-des-séries-temporelles-avec-r-un-exemple-sur-le-bitcoin-" class="section level1">
<h1 class="hasAnchor">
<a href="#application-pratique--analyse-des-s%C3%A9ries-temporelles-avec-r-un-exemple-sur-le-bitcoin-" class="anchor"></a>Application pratique. Analyse des séries temporelles avec R : un exemple sur le Bitcoin.</h1>
<div id="remarques-préliminaires" class="section level2">
<h2 class="hasAnchor">
<a href="#remarques-pr%C3%A9liminaires" class="anchor"></a>Remarques préliminaires</h2>
<p>Dans l’exemple qui suit, on s’intéresse à la modélisation des rendements journaliers du Bitcoin.</p>
<p>Pour faciliter la compréhension, quelques commentaires sont fournis pour l’interprétation des résultats.</p>
</div>
<div id="etape-1---visualisation-des-données" class="section level2">
<h2 class="hasAnchor">
<a href="#etape-1---visualisation-des-donn%C3%A9es" class="anchor"></a>Etape 1.- Visualisation des données</h2>
<p>La commande <code>View</code> permet d’afficher rapidement à l’écran la série en entier.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/View.html">View</a></span><span class="op">(</span><span class="va">bitcoin</span><span class="op">)</span></code></pre></div>
<p>On peut également n’afficher que le début et bien que la fin. Dans ce cas, il faut taper les commandes suivantes :</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">bitcoin</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   Date                Bitcoin</span>
<span class="co">#&gt;   &lt;dttm&gt;                &lt;dbl&gt;</span>
<span class="co">#&gt; 1 2014-12-31 00:00:00    265.</span>
<span class="co">#&gt; 2 2015-01-01 00:00:00    263.</span>
<span class="co">#&gt; 3 2015-01-02 00:00:00    265.</span>
<span class="co">#&gt; 4 2015-01-03 00:00:00    241.</span>
<span class="co">#&gt; 5 2015-01-04 00:00:00    223.</span>
<span class="co">#&gt; 6 2015-01-05 00:00:00    230.</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">bitcoin</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   Date                Bitcoin</span>
<span class="co">#&gt;   &lt;dttm&gt;                &lt;dbl&gt;</span>
<span class="co">#&gt; 1 2018-05-10 00:00:00   7037.</span>
<span class="co">#&gt; 2 2018-05-11 00:00:00   7100.</span>
<span class="co">#&gt; 3 2018-05-12 00:00:00   7280.</span>
<span class="co">#&gt; 4 2018-05-13 00:00:00   7264.</span>
<span class="co">#&gt; 5 2018-05-14 00:00:00   7174.</span>
<span class="co">#&gt; 6 2018-05-15 00:00:00   7064.</span></code></pre></div>
<p>Comme le montrent les sorties <code>R</code>, le fichier a deux séries : <code>Date</code> et <code>Bitcoin</code> (attention de bien respecter les lettres majuscules et minuscules).</p>
</div>
<div id="etape-2---représentation-graphique" class="section level2">
<h2 class="hasAnchor">
<a href="#etape-2---repr%C3%A9sentation-graphique" class="anchor"></a>Etape 2.- Représentation graphique</h2>
<p>Il est nécessaire de transformer l’objet <code>bitcoin</code> en une série temporelle.</p>
<p>Pour ce faire, on appelle le package <code>xts</code>. Puis, on définit une série temporelle, appelée ici <code>coin</code> que l’on peut représenter par la fonction <code>plot</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"xts"</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"xts"</span><span class="op">)</span><span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/xts">xts</a></span><span class="op">)</span>
<span class="co">#&gt; Le chargement a nécessité le package : zoo</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attachement du package : 'zoo'</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     as.Date, as.Date.numeric</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coin</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/xts/man/xts.html">xts</a></span><span class="op">(</span><span class="va">bitcoin</span><span class="op">$</span><span class="va">Bitcoin</span>, order.by <span class="op">=</span> <span class="va">bitcoin</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/notdocumentedyet.html">plot</a></span><span class="op">(</span><span class="va">coin</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div id="commentaire" class="section level2">
<h2 class="hasAnchor">
<a href="#commentaire" class="anchor"></a>Commentaire</h2>
<p>Le graphique montre deux tendances : une première tendance exponentielle de 2014 jusqu’au débit de l’année 2017, et une décroissance exponentielle jusqu’à la fin de la période. Par ailleurs, la série semble avoir plus de volatilité en 2017 et 2018.</p>
<p>La présence des tendances suggère que la série étudiée a peu de chances d’être stationnaire en moyenne.</p>
<p>De plus, les différences de variabilité (avant et après 2017) suggère qu’elle n’est pas non plus stationnaire au second-ordre (c’est-à-dire que la variance et les covariances entre les observations ne sont pas stationnaires).</p>
</div>
<div id="etape-3---transformation-de-la-série-en-log" class="section level2">
<h2 class="hasAnchor">
<a href="#etape-3---transformation-de-la-s%C3%A9rie-en-log" class="anchor"></a>Etape 3.- Transformation de la série en log</h2>
<p>On transforme la série en log pour réduire sa volatilité (une des transformations appartenant à la famille des transformations de Box-Cox).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lcoin</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">coin</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/notdocumentedyet.html">plot</a></span><span class="op">(</span><span class="va">lcoin</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>La transformation en log a deux effets.</p>
<ul>
<li>Tout d’abord, nous « linéarisons » les tendances.</li>
<li>Ensuite, nous homogénéisons la variabilité de la série sur toute la période.</li>
</ul>
</div>
<div id="etape-4---décomposition-de-la-série" class="section level2">
<h2 class="hasAnchor">
<a href="#etape-4---d%C3%A9composition-de-la-s%C3%A9rie" class="anchor"></a>Etape 4.- Décomposition de la série</h2>
<p>Sous <code>R</code>, une manière simple d’obtenir une décomposition d’une série consiste à utiliser la fonction <code>decompose</code>. On suppose ici que la saisonnalité est a-priori hebdomadaire dans la mesure où nous travaillons sur des données journalières <code>frequency = 7</code>.</p>
<p>Par ailleurs, l’hypothèse est faite d’une décomposition additive.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"forecast"</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"forecast"</span><span class="op">)</span><span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://pkg.robjhyndman.com/forecast/">forecast</a></span><span class="op">)</span>
<span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span>
<span class="co">#&gt;   method            from</span>
<span class="co">#&gt;   as.zoo.data.frame zoo</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ts_lcoin</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">lcoin</span>, frequency <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>
<span class="va">decompose_lcoin</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/decompose.html">decompose</a></span><span class="op">(</span><span class="va">ts_lcoin</span>, <span class="st">"additive"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/notdocumentedyet.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">decompose_lcoin</span><span class="op">$</span><span class="va">seasonal</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/notdocumentedyet.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">decompose_lcoin</span><span class="op">$</span><span class="va">trend</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/notdocumentedyet.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">decompose_lcoin</span><span class="op">$</span><span class="va">random</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/notdocumentedyet.html">plot</a></span><span class="op">(</span><span class="va">decompose_lcoin</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Le graphique montre les différentes composantes. Celle qui est aléatoire est en réalité « pseudo-aléatoire » dans la mesure où elle contient également les composantes périodiques et quasi-périodiques de la série.</p>
<p>L’analyse de la saisonnalité sur des données journalières est plus complexe que le fait de simplement supposer que toutes les fins ou début de semaine un événement est susceptible de se répéter.</p>
<p>Cela mérite une attention particulière, notamment s’il est question ensuite de désaisonnaliser la série.</p>
<p>On peut avoir tout type de saisonnalité : mensuelle, annuelle, hebdomadaire, etc.</p>
<p>Dans ce cas, il faut crééer des variables indicatrices (dummies) correspondant aux effets recherchés, puis filtrer la série d’origine à partir d’une régression. Ce point n’est pas développé ici.</p>
<p>En effet, les achats et les ventes de Bitcoin se font en continu, sans fermeture du marché.</p>
<p>Ce marché est moins « structuré » que les marchés d’actifs. Il faut donc être prudent pour ne pas filtrer une composante saisonnière inexistante.</p>
</div>
<div id="etape-5---stationnarisation-de-la-moyenne-de-la-série" class="section level2">
<h2 class="hasAnchor">
<a href="#etape-5---stationnarisation-de-la-moyenne-de-la-s%C3%A9rie" class="anchor"></a>Etape 5.- Stationnarisation de la moyenne de la série</h2>
<p>On commence par définir le rendement à partir de la série d’origine (première ligne).</p>
<p>Puis on ligne omet la valeur manquante de la première observation (après le calcul des rendements).</p>
<p>Le graphique de la série est obtenu grâce aux fonctionalités du package <code>zoo</code> (une autre manière d’obtenir le graphique d’une série temporelle, au lieu de faire appel à la librairie <code>xts</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rlcoin</span> <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">coin</span><span class="op">)</span>,lag<span class="op">=</span><span class="fl">1</span>,differences<span class="op">=</span><span class="fl">1</span><span class="op">)</span>  
<span class="va">rend</span> <span class="op">&lt;-</span> <span class="va">rlcoin</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">rlcoin</span><span class="op">)</span>,<span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"zoo"</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"zoo"</span><span class="op">)</span><span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://zoo.R-Forge.R-project.org/">zoo</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my.panel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/VGAM/man/notdocumentedyet.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/zoo.html">zoo</a></span><span class="op">(</span><span class="va">rend</span>,<span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="va">bitcoin</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Temps"</span>, main<span class="op">=</span><span class="st">"Rendements journaliers"</span>, panel<span class="op">=</span><span class="va">my.panel</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> 
<span class="co">#&gt; Warning in zoo(rend, as.Date(bitcoin$Date)): some methods for "zoo" objects do</span>
<span class="co">#&gt; not work if the index entries in 'order.by' are not unique</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>Le graphique montre des pics (vers le haut et vers le bas) dans la variance des rendements.</p>
<p>Le fait d’avoir calculé la différence premère met la moyenne des rendements à zéro.</p>
<p>Globalement à partir de 2017, la variabilité des rendements semble plus importante que durant les années précédentes. Ces observations suggèrent qu’il est probable que nous ayons stabilisé la moyenne et la variance (non conditionnelles) de la série.</p>
<p>En revanche, il est probable que la variance conditionnelle ne soit pas stable dans le temps.</p>
<p>La stationnarité de la moyenne et de la variance, non conditionnelles, peut être étudiée en appliquant un test de racine unitaire. Le rejet de l’hypothèse de racine unitaire permettrait de conclure que la série d’origine (en log niveau) filtrée de sa composante de racine unitaire est un processus de bruit blanc stationnaire au second ordre.</p>
<p>Faisons le test sous <code>R</code>. Il faut pour cela télécharger le package <code>urca</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"urca"</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"urca"</span><span class="op">)</span><span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">urca</span><span class="op">)</span></code></pre></div>
<p>Un exemple simple d’application est le test ADF. Dans les arguments de la fonction <code>ur.df</code>, on peut choisir un modèle sans constante ni trend, un modèle avec constante seulement (<code>drift</code>), ou un modèle incluant une tendance linéaire. Les résultats peuvent être affichés grâce à la fonction <code>summary</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df1</span> <span class="op">=</span> <span class="fu">urca</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/ur.df.html">ur.df</a></span><span class="op">(</span><span class="va">rend</span>,type<span class="op">=</span><span class="st">"none"</span>,lags<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">df2</span> <span class="op">=</span> <span class="fu">urca</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/ur.df.html">ur.df</a></span><span class="op">(</span><span class="va">rend</span>,type<span class="op">=</span><span class="st">"none"</span>,lags<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">df3</span> <span class="op">=</span> <span class="fu">urca</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/urca/man/ur.df.html">ur.df</a></span><span class="op">(</span><span class="va">rend</span>,type<span class="op">=</span><span class="st">"none"</span>,lags<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ############################################### </span>
<span class="co">#&gt; # Augmented Dickey-Fuller Test Unit Root Test # </span>
<span class="co">#&gt; ############################################### </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test regression none </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = z.diff ~ z.lag.1 - 1 + z.diff.lag)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;       Min        1Q    Median        3Q       Max </span>
<span class="co">#&gt; -0.248803 -0.010187  0.003012  0.018642  0.243286 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;            Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; z.lag.1    -1.00861    0.04032 -25.014   &lt;2e-16 ***</span>
<span class="co">#&gt; z.diff.lag  0.01050    0.02854   0.368    0.713    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.04045 on 1228 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.4991, Adjusted R-squared:  0.4983 </span>
<span class="co">#&gt; F-statistic: 611.8 on 2 and 1228 DF,  p-value: &lt; 2.2e-16</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Value of test-statistic is: -25.0142 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Critical values for test statistics: </span>
<span class="co">#&gt;       1pct  5pct 10pct</span>
<span class="co">#&gt; tau1 -2.58 -1.95 -1.62</span></code></pre></div>
<p>Les résultats pour le test sans constante ni tendance linéaire conduisent à rejeter l’hypothèse de racine unitaire contre celle d’une série de rendement intégrée d’ordre 0, donc stationnaire à l’ordre 1. Des résultats similaires sont obtenus pour les deux autres modèles.</p>
<p>Mais, on peut mettre en évidence une absence de stationnarité de la variance conditionnelle.</p>
<p>Pour ce faire, intéressons-nous à la distribution empirique de la série des rendements.</p>
<p>On utilise ici deux packages (<code>fitdistrplus</code> et <code>car</code>) permettant de représenter la distribution de la série et de mettre en évidence ses principales caractéristiques.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"fitdistrplus"</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"fitdistrplus"</span><span class="op">)</span><span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lbbe.univ-lyon1.fr/fitdistrplus.html">fitdistrplus</a></span><span class="op">)</span>
<span class="co">#&gt; Le chargement a nécessité le package : MASS</span>
<span class="co">#&gt; Le chargement a nécessité le package : survival</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rendement</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">rend</span><span class="op">)</span>
<span class="fu">fitdistrplus</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/plotdist.html">plotdist</a></span><span class="op">(</span><span class="va">rendement</span>, histo <span class="op">=</span> <span class="cn">TRUE</span>, demp <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>L’absence de stationnarité en variance apparaît de deux manières.</p>
<p>Tout d’abord, la densité des rendements fait apparaître des valeurs extrêmes (des valeurs inférieures et supérieures, qui sont éloignées des autres valeurs de la série).</p>
<p>Ensuite, en observant la figure des quantiles, on peut noter que pour ces valeurs extrêmes, les quantiles calculées à partir de la densité estimée sont éloignées de celles d’une loi normale (les points à chaque extrémité se situent en dehors de la droite de Henry).</p>
</div>
<div id="etape-6---corrélogramme" class="section level2">
<h2 class="hasAnchor">
<a href="#etape-6---corr%C3%A9logramme" class="anchor"></a>Etape 6.- Corrélogramme</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">rendement</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>La fonction <code>acf</code> ne montre aucun pic significatif (en dehors de l’autocorrélation en zéro qui vaut 1 par définition).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="va">rendement</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>La fonction <code>pacf</code> ne montre aucun pic significatif non plus, ce qui laisse supposer que le logarithme des rendements est un bruit blanc.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/zoo.html">zoo</a></span><span class="op">(</span><span class="va">rend</span>,<span class="va">bitcoin</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Temps"</span>, main<span class="op">=</span><span class="st">"Rendements journaliers"</span>, panel<span class="op">=</span><span class="va">my.panel</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning in zoo(rend, bitcoin$Date): some methods for "zoo" objects do not work</span>
<span class="co">#&gt; if the index entries in 'order.by' are not unique</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>On peut le vérifier en demandant à <code>R</code> de trouver le meilleur modèle AR.</p>
<p>Il faut d’abord installer le package suivant :</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"fArma"</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"fArma"</span>, repos<span class="op">=</span><span class="st">"https://R-Forge.R-project.org"</span><span class="op">)</span><span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.rmetrics.org">fArma</a></span><span class="op">)</span>
<span class="co">#&gt; Le chargement a nécessité le package : timeDate</span>
<span class="co">#&gt; Le chargement a nécessité le package : timeSeries</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attachement du package : 'timeSeries'</span>
<span class="co">#&gt; The following object is masked from 'package:zoo':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     time&lt;-</span>
<span class="co">#&gt; Le chargement a nécessité le package : fBasics</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ar.html">ar</a></span><span class="op">(</span><span class="va">rendement</span>,aic<span class="op">=</span><span class="cn">TRUE</span>,order.max <span class="op">=</span> <span class="fl">4</span>,method<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yule-walker"</span><span class="op">)</span><span class="op">)</span>
<span class="va">fit1</span> 
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; ar(x = rendement, aic = TRUE, order.max = 4, method = c("yule-walker"))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Order selected 0  sigma^2 estimated as  0.001625</span></code></pre></div>
<p>On peut noter que le meilleur modèle <span class="math inline">\(\mathrm{AR}\)</span> sélectionné a zéro retard, ce qui signifie que le processus n’a pas de mémoire.</p>
</div>
<div id="etape-7---modélisation-box-jenkins-de-la-valeur-absolue-des-rendements" class="section level2">
<h2 class="hasAnchor">
<a href="#etape-7---mod%C3%A9lisation-box-jenkins-de-la-valeur-absolue-des-rendements" class="anchor"></a>Etape 7.- Modélisation Box-Jenkins de la valeur absolue des rendements</h2>
<p>Représentation de la valeur absolue des rendements</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">absrend</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">rend</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">my.panel</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/zoo.html">zoo</a></span><span class="op">(</span><span class="va">absrend</span>,<span class="va">bitcoin</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"Temps"</span>, main<span class="op">=</span><span class="st">"Valeur absolue des rendements journaliers"</span>, panel<span class="op">=</span><span class="va">my.panel</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span>  
<span class="co">#&gt; Warning in zoo(absrend, bitcoin$Date): some methods for "zoo" objects do not</span>
<span class="co">#&gt; work if the index entries in 'order.by' are not unique</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
</div>
</div>
<div id="fonctions-acf-et-pacf-avec-30-retards" class="section level1">
<h1 class="hasAnchor">
<a href="#fonctions-acf-et-pacf-avec-30-retards" class="anchor"></a>Fonctions ACF et PACF avec 30 retards</h1>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">absrendement</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">rendement</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">absrendement</span>,<span class="fl">30</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="va">absrendement</span>,<span class="fl">30</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
<p>La série de la valeur absolue des rendements est un indicateur de la variabilité de la série des rendements.</p>
<p>On peut remarquer que, contrairement à la série des rendements elle-même, la fonction ACF montre une décroissance très lente vers zéro et que de nombreux pics de la fonction PACF sont significatif.</p>
<p>C’est donc un processus qui a de la mémoire.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ar.html">ar</a></span><span class="op">(</span><span class="va">absrendement</span>,aic<span class="op">=</span><span class="cn">TRUE</span>,order.max <span class="op">=</span> <span class="fl">16</span>,method<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"yule-walker"</span><span class="op">)</span><span class="op">)</span>
<span class="va">fit2</span> 
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; ar(x = absrendement, aic = TRUE, order.max = 16, method = c("yule-walker"))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;      1       2       3       4       5       6       7       8       9      10  </span>
<span class="co">#&gt; 0.2247  0.0536  0.0323  0.0282  0.0925  0.0429  0.0084  0.0536  0.0339  0.0429  </span>
<span class="co">#&gt;     11      12      13      14      15  </span>
<span class="co">#&gt; 0.0123  0.0241  0.0354  0.0137  0.0595  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Order selected 15  sigma^2 estimated as  0.0007895</span></code></pre></div>
<p>Si nous décidions d’ajuster un processus <span class="math inline">\(\mathrm{AR}\)</span> pur à la série, celui-ci comporterait un nombre de retards très élevé.</p>
<p>En effet, le meilleur modèle trouvé par <code>R</code> sur la base du critère AIC est un <span class="math inline">\(\mathrm{AR}(15)\)</span>.</p>
<p>Cependant, pour des raisons de parcimonie, il vaut mieux modéliser la série par un modèle <span class="math inline">\(\mathrm{ARMA}\)</span>, ce qui permet de réduire le nombre de retards de la composante <span class="math inline">\(\mathrm{AR}\)</span>.</p>
<p>Par ailleurs, si nous faisons la somme des coefficients de ce modèle, nous obtenons une valeur supérieure à 1, c’est-à-dire un modèle AR non stationnaire.</p>
<p>Pour trouver le meilleur modèle <span class="math inline">\(\mathrm{ARMA}\)</span>, nous utilisons le package <code>timsac</code> et la fonction <code>autoarmafit</code>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"timsac"</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"timsac"</span><span class="op">)</span><span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">timsac</span><span class="op">)</span></code></pre></div>
<p>La fonction <code>autoarmafit</code> est instable avec le jeu de données <code>bitcoin</code>. Il est nécessaire de relancer plusieurs l’ajustement pour btenir le résultat. La boucle suivante relance automatiquement cette fonction <code>autoarmafit</code> jusqu’à l’obtention d’un résultat.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pass</span><span class="op">=</span><span class="cn">FALSE</span>
<span class="va">count</span><span class="op">=</span> <span class="fl">0</span>
<span class="kw">while</span><span class="op">(</span><span class="op">!</span><span class="va">pass</span> <span class="op">&amp;</span> <span class="va">count</span><span class="op">&lt;</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="op">{</span><span class="va">count</span> <span class="op">=</span> <span class="va">count</span><span class="op">+</span><span class="fl">1</span>; <span class="va">resfitarma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/timsac/man/autoarmafit.html">autoarmafit</a></span><span class="op">(</span><span class="va">absrend</span><span class="op">)</span> ; <span class="va">pass</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">}</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">resfitarma</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Case No. 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AR coefficient  Standard deviation</span>
<span class="co">#&gt;  1.190080    0.004809</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  MA coefficient  Standard deviation</span>
<span class="co">#&gt;  0.922302    0.002106</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AIC -9824.960897</span>
<span class="co">#&gt;  Innovation variance 0.000343</span>
<span class="co">#&gt;  Final gradient  -1.330943e-02   -6.947614e-03</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Case No. 2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AR coefficient  Standard deviation</span>
<span class="co">#&gt;  1.190080    0.004993</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  MA coefficient  Standard deviation</span>
<span class="co">#&gt;  0.922302    0.016243</span>
<span class="co">#&gt;  -0.000000   0.015685</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AIC -9822.960897</span>
<span class="co">#&gt;  Innovation variance 0.000343</span>
<span class="co">#&gt;  Final gradient  -1.330943e-02   -1.293673e-02   -6.947614e-03</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Case No. 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AR coefficient  Standard deviation</span>
<span class="co">#&gt;  1.190080    1.773884</span>
<span class="co">#&gt;  -0.000000   2.110639</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  MA coefficient  Standard deviation</span>
<span class="co">#&gt;  0.922302    1.773178</span>
<span class="co">#&gt;  -0.000000   1.635912</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AIC -9820.960897</span>
<span class="co">#&gt;  Innovation variance 0.000343</span>
<span class="co">#&gt;  Final gradient  -1.330943e-02   -1.293673e-02   -6.947614e-03   -6.993313e-03</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Case No. 4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AR coefficient  Standard deviation</span>
<span class="co">#&gt;  1.190080    0.030651</span>
<span class="co">#&gt;  -0.179966   0.030506</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  MA coefficient  Standard deviation</span>
<span class="co">#&gt;  0.922302    0.012425</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AIC -8899.608718</span>
<span class="co">#&gt;  Innovation variance 0.000726</span>
<span class="co">#&gt;  Final gradient  3.644612e-05    -8.192525e-04   -7.917232e-04</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Case No. 5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AR coefficient  Standard deviation</span>
<span class="co">#&gt;  0.488862    0.061100</span>
<span class="co">#&gt;  -0.992404   0.063376</span>
<span class="co">#&gt;  0.324640    0.031418</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  MA coefficient  Standard deviation</span>
<span class="co">#&gt;  0.159324    0.057111</span>
<span class="co">#&gt;  -0.953095   0.054989</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AIC -8709.395537</span>
<span class="co">#&gt;  Innovation variance 0.000844</span>
<span class="co">#&gt;  Final gradient  2.095691e-05    -4.740846e-05   -1.696870e-05   3.381068e-05    2.339559e-05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Case No. 6</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AR coefficient  Standard deviation</span>
<span class="co">#&gt;  0.488862    1.012758</span>
<span class="co">#&gt;  -0.992404   0.497869</span>
<span class="co">#&gt;  0.324640    1.005610</span>
<span class="co">#&gt;  0.000000    0.330087</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  MA coefficient  Standard deviation</span>
<span class="co">#&gt;  0.159324    1.012517</span>
<span class="co">#&gt;  -0.953095   0.170246</span>
<span class="co">#&gt;  0.000000    0.965432</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AIC -8705.395537</span>
<span class="co">#&gt;  Innovation variance 0.000844</span>
<span class="co">#&gt;  Final gradient  2.095691e-05    -4.740846e-05   5.011632e-06    -1.696870e-05   3.381068e-05    2.339559e-05    7.087112e-05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Case No. 7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AR coefficient  Standard deviation</span>
<span class="co">#&gt;  0.006854    3.668007</span>
<span class="co">#&gt;  0.002697    -0.000000</span>
<span class="co">#&gt;  0.026011    8338817624868309782300154535867981891532840462182926600231204659661548683560336611902894973066694942104671537161383549540325172925869742276116834849318554939887493339101858254016767246467072.000000</span>
<span class="co">#&gt;  -0.057293   773771846598217755631739308254425007090066840688974126391126883819414640032068001300994515997917416316788728610193473721228616318574841427174822032105799680.000000</span>
<span class="co">#&gt;  0.010207    1042497917008583210824624970127108915126976194832432606877611089274185568787185215043943855049088252402208426973214298476823579450817646539157992782366877145373179176614884248531416489156288167153153611188641866087410848082318364305428745668456125464842963758612480.000000</span>
<span class="co">#&gt;  0.017021    746330307694236338238942658687354320841057851530522132480.000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  MA coefficient  Standard deviation</span>
<span class="co">#&gt;  0.922302    0.000722</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AIC -7132.319428</span>
<span class="co">#&gt;  Innovation variance 0.003055</span>
<span class="co">#&gt;  Final gradient  -3.661557e-01   5.304990e-313   1.226514e-311   2.440295e-311   NaN NaN 4.328871e-312</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Case No. 8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AR coefficient  Standard deviation</span>
<span class="co">#&gt;  0.025960    0.000000</span>
<span class="co">#&gt;  0.017487    0.000000</span>
<span class="co">#&gt;  0.019145    -6723736.414648</span>
<span class="co">#&gt;  0.025837    -1262712591965989632.000000</span>
<span class="co">#&gt;  0.022076    0.000000</span>
<span class="co">#&gt;  0.018524    122999027389912291110584628017770320002544900574014987373129924270868077717933051084800.000000</span>
<span class="co">#&gt;  0.024792    -0.000000</span>
<span class="co">#&gt;  0.023082    -0.000000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  MA coefficient  Standard deviation</span>
<span class="co">#&gt;  0.922302    0.019802</span>
<span class="co">#&gt;  -0.000000   0.019802</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  AIC -7130.319428</span>
<span class="co">#&gt;  Innovation variance 0.003055</span>
<span class="co">#&gt;  Final gradient  -3.661557e-01   -3.599999e-01   NaN NaN 1.107682e-311   NaN 2.563371e-311   NaN 2.136850e-311   NaN</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Best ARMA model</span>
<span class="co">#&gt;  AR coefficient (order = 1)  1.190080</span>
<span class="co">#&gt;  MA coefficient (order = 1)  0.922302</span></code></pre></div>
<p>Le meilleur modèle sur la base des critères d’information est un <span class="math inline">\(\mathrm{ARMA}(1,1)\)</span>.</p>
<p>Nous estimons donc un modèle <span class="math inline">\(\mathrm{ARIMA}(p,d,q)\)</span>, avec <span class="math inline">\(d=0\)</span> et <span class="math inline">\(p=q=1\)</span> et appliquons des tests de diagnostic sur les résidus estimés</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit3</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">absrendement</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; arima(x = absrendement, order = c(1, 0, 1))</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;          ar1      ma1  intercept</span>
<span class="co">#&gt;       0.9655  -0.8495     0.0261</span>
<span class="co">#&gt; s.e.  0.0141   0.0317     0.0034</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; sigma^2 estimated as 0.0007948:  log likelihood = 2648.21,  aic = -5288.42</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Training set error measures:</span>
<span class="co">#&gt;                        ME       RMSE        MAE       MPE     MAPE      MASE</span>
<span class="co">#&gt; Training set -5.52245e-05 0.02819305 0.01873146 -589.4972 616.9377 0.8091762</span>
<span class="co">#&gt;                   ACF1</span>
<span class="co">#&gt; Training set 0.1052497</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/urca/man/plot-methods.html">plot</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://pkg.robjhyndman.com/forecast/reference/checkresiduals.html">checkresiduals</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-39-1.png" width="700"></p>
<pre><code>#&gt; 
#&gt;  Ljung-Box test
#&gt; 
#&gt; data:  Residuals from ARIMA(1,0,1) with non-zero mean
#&gt; Q* = 24.079, df = 7, p-value = 0.001104
#&gt; 
#&gt; Model df: 3.   Total lags used: 10</code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span>
<span class="co">#&gt; Le chargement a nécessité le package : carData</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attachement du package : 'car'</span>
<span class="co">#&gt; The following object is masked from 'package:fBasics':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     densityPlot</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/qqPlot.html">qqPlot</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-41-1.png" width="700"></p>
<pre><code>#&gt; [1]   14 1072</code></pre>
<p>L’estimation du modèle <span class="math inline">\(\mathrm{ARMA}(1,1)\)</span> montre un modèle dont les composantes <span class="math inline">\(\mathrm{AR}\)</span> et <span class="math inline">\(\mathrm{MA}\)</span> sont proches de racine unitaire, ce qui n’est pas étonnant au vu des fonctions <code>acf</code> et <code>pacf</code>.</p>
<p>On peut donc s’attendre à ce qu’un choc ait des effets persistants sur la volatilité de la série des rendements.</p>
<p>Pour savoir si le modèle est convenablement estimé, il convient d’examiner :</p>
<ul>
<li>les résidus standardisés ;</li>
<li>la fonction ACF des résidus ;</li>
<li>le QQ-plot ;</li>
<li>et effectuer des tests de corrélation des résidus.</li>
</ul>
<p>La fonction <code>checkresiduals</code> permet de vérifier les propriétés des résidus d’estimation et la fonction <code>qqPlot</code> du package <code>car</code> permet de tracer le diagramme comparatif des quantiles des résidus estimés par rapport à ceux d’une loi normale. Les figures montrent que les résidus ne suivent pas un processus de bruit blanc mais contiennent des autocorrélations.</p>
<p>Le dernier graphique montre une différence entre les quantiles des résidus et ceux d’une loi gausienne, notamment pour les valeurs les plus élevées.</p>
<div id="etape-8---modélisation-archgarch-des-résidus" class="section level2">
<h2 class="hasAnchor">
<a href="#etape-8---mod%C3%A9lisation-archgarch-des-r%C3%A9sidus" class="anchor"></a>Etape 8.- Modélisation ARCH/GARCH des résidus</h2>
<p>On prend l’exemple d’un effet <span class="math inline">\(\mathrm{ARCH}(2)\)</span>, la procédure étant valable pour n’importe quel retard.</p>
<p>Il suffit de changer dans l’option <code>lags</code> le retard souhaité.</p>
<p>Nous avons vu que la moyenne de la série des rendements était proche de zéro et que le meilleur modèle pour décrire la moyenne conditionnelle est un bruit blanc. Par ailleurs, nous avons constaté que la variabilité des rendements comporte des autocorrélations décrites par un modèle <span class="math inline">\(\mathrm{ARMA}\)</span>.</p>
<p>La même conclusion s’appliquerait si l’on modélisait le carré des rendements. Or, nous savons qu’un modèle <span class="math inline">\(\mathrm{GARCH}\)</span> appliqué à une série donnée peut être représentée sous la forme d’un modèle <span class="math inline">\(\mathrm{ARMA}\)</span> appliqué aux carrés des observations initiales.</p>
<p>Nous effectuons donc le test ARCH sur les rentabilités. En effet, au vu de ce qui vient d’être dit, il est probable qu’elles soient décrites par un bruit blanc avec une variance conditionnelle hétéroscédastique.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"FinTS"</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"FinTS"</span><span class="op">)</span><span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/fints/">FinTS</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attachement du package : 'FinTS'</span>
<span class="co">#&gt; The following object is masked from 'package:forecast':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Acf</span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rend.archTest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/FinTS/man/ArchTest.html">ArchTest</a></span><span class="op">(</span><span class="va">rend</span>, lags <span class="op">=</span> <span class="fl">2</span>, demean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">rend.archTest</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  ARCH LM-test; Null hypothesis: no ARCH effects</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  rend</span>
<span class="co">#&gt; Chi-squared = 166.99, df = 2, p-value &lt; 2.2e-16</span></code></pre></div>
<p>Comme on le voit, l’hypothèse nulle d’absence d’effets ARCH est rejetée.</p>
<p>Estimation d’un modèle GARCH</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"fGarch"</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"fGarch"</span><span class="op">)</span><span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.rmetrics.org">fGarch</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="st">"tseries"</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"tseries"</span><span class="op">)</span><span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">tseries</span><span class="op">)</span>
<span class="co">#&gt; Le chargement a nécessité le package : tseries</span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rend.garch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tseries/man/garch.html">garch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">rend</span><span class="op">)</span>, trace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Warning in sqrt(pred$e): production de NaN</span>
<span class="va">rend.fitgarch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fGarch/man/garchFit.html">garchFit</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/tseries/man/garch.html">garch</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">rend</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Series Initialization:</span>
<span class="co">#&gt;  ARMA Model:                arma</span>
<span class="co">#&gt;  Formula Mean:              ~ arma(0, 0)</span>
<span class="co">#&gt;  GARCH Model:               garch</span>
<span class="co">#&gt;  Formula Variance:          ~ garch(1, 1)</span>
<span class="co">#&gt;  ARMA Order:                0 0</span>
<span class="co">#&gt;  Max ARMA Order:            0</span>
<span class="co">#&gt;  GARCH Order:               1 1</span>
<span class="co">#&gt;  Max GARCH Order:           1</span>
<span class="co">#&gt;  Maximum Order:             1</span>
<span class="co">#&gt;  Conditional Dist:          norm</span>
<span class="co">#&gt;  h.start:                   2</span>
<span class="co">#&gt;  llh.start:                 1</span>
<span class="co">#&gt;  Length of Series:          1232</span>
<span class="co">#&gt;  Recursion Init:            mci</span>
<span class="co">#&gt;  Series Scale:              0.04031482</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Parameter Initialization:</span>
<span class="co">#&gt;  Initial Parameters:          $params</span>
<span class="co">#&gt;  Limits of Transformations:   $U, $V</span>
<span class="co">#&gt;  Which Parameters are Fixed?  $includes</span>
<span class="co">#&gt;  Parameter Matrix:</span>
<span class="co">#&gt;                      U           V     params includes</span>
<span class="co">#&gt;     mu     -0.66104924   0.6610492 0.06610492     TRUE</span>
<span class="co">#&gt;     omega   0.00000100 100.0000000 0.10000000     TRUE</span>
<span class="co">#&gt;     alpha1  0.00000001   1.0000000 0.10000000     TRUE</span>
<span class="co">#&gt;     gamma1 -0.99999999   1.0000000 0.10000000    FALSE</span>
<span class="co">#&gt;     beta1   0.00000001   1.0000000 0.80000000     TRUE</span>
<span class="co">#&gt;     delta   0.00000000   2.0000000 2.00000000    FALSE</span>
<span class="co">#&gt;     skew    0.10000000  10.0000000 1.00000000    FALSE</span>
<span class="co">#&gt;     shape   1.00000000  10.0000000 4.00000000    FALSE</span>
<span class="co">#&gt;  Index List of Parameters to be Optimized:</span>
<span class="co">#&gt;     mu  omega alpha1  beta1 </span>
<span class="co">#&gt;      1      2      3      5 </span>
<span class="co">#&gt;  Persistence:                  0.9 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; --- START OF TRACE ---</span>
<span class="co">#&gt; Selected Algorithm: nlminb </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; R coded nlminb Solver: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   0:     1582.4632: 0.0661049 0.100000 0.100000 0.800000</span>
<span class="co">#&gt;   1:     1557.6022: 0.0661056 0.0720138 0.105168 0.786470</span>
<span class="co">#&gt;   2:     1508.8654: 0.0661073 0.0247098 0.192060 0.810201</span>
<span class="co">#&gt;   3:     1508.5403: 0.0661061 0.0164188 0.191462 0.807677</span>
<span class="co">#&gt;   4:     1507.1867: 0.0661054 0.0202609 0.192672 0.809303</span>
<span class="co">#&gt;   5:     1506.9976: 0.0660911 0.0178896 0.193144 0.812905</span>
<span class="co">#&gt;   6:     1506.9800: 0.0660896 0.0186570 0.193963 0.813410</span>
<span class="co">#&gt;   7:     1506.9214: 0.0660758 0.0180143 0.194641 0.812637</span>
<span class="co">#&gt;   8:     1506.8657: 0.0660474 0.0185644 0.196859 0.811829</span>
<span class="co">#&gt;   9:     1506.7711: 0.0659720 0.0185989 0.199807 0.808055</span>
<span class="co">#&gt;  10:     1506.6497: 0.0655732 0.0198645 0.206230 0.803847</span>
<span class="co">#&gt;  11:     1506.6016: 0.0650174 0.0169124 0.208413 0.807425</span>
<span class="co">#&gt;  12:     1506.4979: 0.0644215 0.0183732 0.210593 0.804461</span>
<span class="co">#&gt;  13:     1506.4899: 0.0638859 0.0188138 0.212683 0.799288</span>
<span class="co">#&gt;  14:     1506.4450: 0.0635737 0.0196571 0.213777 0.799430</span>
<span class="co">#&gt;  15:     1506.4158: 0.0632545 0.0191392 0.214542 0.799156</span>
<span class="co">#&gt;  16:     1506.3920: 0.0626155 0.0192583 0.216414 0.799057</span>
<span class="co">#&gt;  17:     1506.3559: 0.0613262 0.0189082 0.218578 0.797454</span>
<span class="co">#&gt;  18:     1506.3297: 0.0601546 0.0198797 0.225131 0.791993</span>
<span class="co">#&gt;  19:     1506.3234: 0.0588542 0.0196058 0.224975 0.792854</span>
<span class="co">#&gt;  20:     1506.3218: 0.0594187 0.0194383 0.225991 0.792599</span>
<span class="co">#&gt;  21:     1506.3217: 0.0593140 0.0194565 0.225920 0.792714</span>
<span class="co">#&gt;  22:     1506.3217: 0.0592585 0.0194423 0.225840 0.792751</span>
<span class="co">#&gt;  23:     1506.3217: 0.0592828 0.0194455 0.225868 0.792732</span>
<span class="co">#&gt;  24:     1506.3217: 0.0592812 0.0194455 0.225866 0.792733</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Final Estimate of the Negative LLH:</span>
<span class="co">#&gt;  LLH:  -2449.675    norm LLH:  -1.988373 </span>
<span class="co">#&gt;           mu        omega       alpha1        beta1 </span>
<span class="co">#&gt; 2.389911e-03 3.160443e-05 2.258665e-01 7.927335e-01 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; R-optimhess Difference Approximated Hessian Matrix:</span>
<span class="co">#&gt;                  mu        omega        alpha1         beta1</span>
<span class="co">#&gt; mu     -2012069.087      4414224      2073.153      1129.307</span>
<span class="co">#&gt; omega   4414224.412 -49770170034 -12382881.911 -25661577.445</span>
<span class="co">#&gt; alpha1     2073.153    -12382882     -7564.989    -11848.623</span>
<span class="co">#&gt; beta1      1129.307    -25661577    -11848.623    -21545.991</span>
<span class="co">#&gt; attr(,"time")</span>
<span class="co">#&gt; Time difference of 0.01623797 secs</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; --- END OF TRACE ---</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Time to Estimate Parameters:</span>
<span class="co">#&gt;  Time difference of 0.06680989 secs</span>
<span class="co">#&gt; Warning: Using formula(x) is deprecated when x is a character vector of length &gt; 1.</span>
<span class="co">#&gt;   Consider formula(paste(x, collapse = " ")) instead.</span>
<span class="fu"><a href="https://rdrr.io/pkg/urca/man/summary-methods.html">summary</a></span><span class="op">(</span><span class="va">rend.fitgarch</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Title:</span>
<span class="co">#&gt;  GARCH Modelling </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt;  garchFit(formula = ~garch(1, 1), data = rend) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mean and Variance Equation:</span>
<span class="co">#&gt;  data ~ garch(1, 1)</span>
<span class="co">#&gt; &lt;environment: 0x7f834d32f698&gt;</span>
<span class="co">#&gt;  [data = rend]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Conditional Distribution:</span>
<span class="co">#&gt;  norm </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficient(s):</span>
<span class="co">#&gt;         mu       omega      alpha1       beta1  </span>
<span class="co">#&gt; 2.3899e-03  3.1604e-05  2.2587e-01  7.9273e-01  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Std. Errors:</span>
<span class="co">#&gt;  based on Hessian </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error Analysis:</span>
<span class="co">#&gt;         Estimate  Std. Error  t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; mu     2.390e-03   7.057e-04    3.387 0.000707 ***</span>
<span class="co">#&gt; omega  3.160e-05   7.822e-06    4.040 5.34e-05 ***</span>
<span class="co">#&gt; alpha1 2.259e-01   3.348e-02    6.746 1.52e-11 ***</span>
<span class="co">#&gt; beta1  7.927e-01   2.459e-02   32.241  &lt; 2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Log Likelihood:</span>
<span class="co">#&gt;  2449.675    normalized:  1.988373 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Description:</span>
<span class="co">#&gt;  Sat Aug  7 18:04:50 2021 by user:  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Standardised Residuals Tests:</span>
<span class="co">#&gt;                                 Statistic p-Value     </span>
<span class="co">#&gt;  Jarque-Bera Test   R    Chi^2  1218.332  0           </span>
<span class="co">#&gt;  Shapiro-Wilk Test  R    W      0.9335583 0           </span>
<span class="co">#&gt;  Ljung-Box Test     R    Q(10)  32.07275  0.0003894103</span>
<span class="co">#&gt;  Ljung-Box Test     R    Q(15)  35.41594  0.002144752 </span>
<span class="co">#&gt;  Ljung-Box Test     R    Q(20)  41.2902   0.003418284 </span>
<span class="co">#&gt;  Ljung-Box Test     R^2  Q(10)  10.02653  0.4381686   </span>
<span class="co">#&gt;  Ljung-Box Test     R^2  Q(15)  14.15706  0.5136526   </span>
<span class="co">#&gt;  Ljung-Box Test     R^2  Q(20)  23.51934  0.2640189   </span>
<span class="co">#&gt;  LM Arch Test       R    TR^2   10.705    0.5543548   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Information Criterion Statistics:</span>
<span class="co">#&gt;       AIC       BIC       SIC      HQIC </span>
<span class="co">#&gt; -3.970252 -3.953640 -3.970273 -3.964002</span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">rend.fitgarch</span><span class="op">@</span><span class="va">residuals</span><span class="op">)</span></code></pre></div>
<p><img src="CodeChap11_files/figure-html/unnamed-chunk-47-1.png" width="700"></p>
<p>À titre d’exemple, nous estimons un modèle <span class="math inline">\(\mathrm{GARCH}(1,1)\)</span>. Le corrélograme montre que les résidus ne contiennent plus d’autocorrélation, mais les tests de Ljung-Box montrent que des autocorrélations subsistent dans les résidus d’estimation.</p>
<p>En effet, les niveaux de significativité des tests (<span class="math inline">\(p\)</span>-value) sont petits et inférieurs à <span class="math inline">\(5\%\)</span>.</p>
<p>Mais, ces autocorrélations ne captent plus des effets ARCH (la <span class="math inline">\(p\)</span>-pvalue du test ARCH dépasse <span class="math inline">\(5\%\)</span>).</p>
<p>Les autocorrélations qui subsistent correspondent vraisemblablement à d’autres hypothèses (par exemple l’existence de dynamiques non-linéaires).</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Frederic Bertrand, Myriam Maumy-Bertrand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
