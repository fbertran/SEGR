<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapitre 10. Modèles gaussiens de régressions linéaires simple et multiple. • sageR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Chapitre 10. Modèles gaussiens de régressions linéaires simple et multiple.">
<meta property="og:description" content="sageR">
<meta property="og:image" content="https://fbertran.github.io/sageR/reference/figures/logo.png">
<meta property="og:image:alt" content="Statistiques pour l’économie et la gestion">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@BertrandFrdric2">
<meta name="twitter:site" content="@deboeck">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sageR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/AllLinksExtVignettes.html">Liens vers la vignette de chaque chapitre.</a>
    </li>
    <li>
      <a href="../articles/CodeChap01.html">Chapitre 01. La statistique et la collecte des données.</a>
    </li>
    <li>
      <a href="../articles/CodeChap02.html">Chapitre 02. Statistiques descriptives et visualisation des données univariables.</a>
    </li>
    <li>
      <a href="../articles/CodeChap03.html">Chapitre 03.	Statistiques descriptives et visualisation des données bivariables ou multivariables.</a>
    </li>
    <li>
      <a href="../articles/CodeChap04.html">Chapitre 04. Analyse en composantes principales (ACP).</a>
    </li>
    <li>
      <a href="../articles/CodeChap05.html">Chapitre 05. Analyse factorielle des correspondances (AFC).</a>
    </li>
    <li>
      <a href="../articles/CodeChap06.html">Chapitre 06. Analyse des correspondances multiples (ACM).</a>
    </li>
    <li>
      <a href="../articles/CodeChap07.html">Chapitre 07. Classification automatique.</a>
    </li>
    <li>
      <a href="../articles/CodeChap08.html">Chapitre 08. Théorie des probabilités.</a>
    </li>
    <li>
      <a href="../articles/CodeChap09.html">Chapitre 09. Inférence statistique.</a>
    </li>
    <li>
      <a href="../articles/CodeChap10.html">Chapitre 10. Modèles gaussiens de régressions linéaires simple et multiple.</a>
    </li>
    <li>
      <a href="../articles/CodeChap11.html">Chapitre 11. Introduction aux séries temporelles.</a>
    </li>
    <li>
      <a href="../articles/CodeChap12.html">Chapitre 12. Introduction aux modèles logit et probit.</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fbertran/sageR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Chapitre 10. Modèles gaussiens de régressions
linéaires simple et multiple.</h1>
            <h3 data-toc-skip class="subtitle">Tout le code avec R.</h3>
                        <h4 data-toc-skip class="author">Christian
Derquenne</h4>
            
            <h4 data-toc-skip class="date">2022-09-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/fbertran/sageR/blob/HEAD/vignettes/CodeChap10.Rmd" class="external-link"><code>vignettes/CodeChap10.Rmd</code></a></small>
      <div class="hidden name"><code>CodeChap10.Rmd</code></div>

    </div>

    
    
<table align="center" class="table"><tr>
<td>
<img src="../reference/figures/9782807319448-g.jpg" align="left" width="300" style="margin:0 100 0 0;">
</td>
<td>
<img src="../reference/figures/logo.png" align="right" width="200" style="margin:0 0 0 100;">
</td>
</tr></table>
<div class="section level2">
<h2 id="description-des-données-air-pollution">Description des données : Air pollution<a class="anchor" aria-label="anchor" href="#description-des-donn%C3%A9es-air-pollution"></a>
</h2>
<p>Échantillon de 50 villes (individus) tirées aléatoirement sur la
pollution de l’air aux États-Unis en 1960</p>
<ul>
<li>CITY : Nom de la ville</li>
<li>TMR : taux de mortalité exprimé en 1/10000</li>
<li>GE65 : pourcentage (multiplié par 10) de la population des 65 ans et
plus</li>
<li>LPOP : logarithme (en base 10 et multiplié par 10) de la
population</li>
<li>NONPOOR : pourcentage de ménages avec un revenu au dessus du seuil
de pauvreté</li>
<li>PERWH : pourcentage de population blanche * PMEAN : moyenne
arithmétique des relevés réalisés deux fois par semaine de particules
suspendues dans l’air (micro-g/m3 multiplié par 10)</li>
<li>PMIN : plus petite valeur des relevés réalisés deux fois par semaine
de particules suspendues dans l’air (micro-g/m3 multiplié par 10)</li>
<li>LPMAX : logarithme de la plus grande valeur des relevés réalisés
deux fois par semaine de particules suspendues dans l’air (micro-g/m3
multiplié par 10)</li>
<li>SMEAN : moyenne arithmétique des relevés réalisés deux fois par
semaine de sulfate (micro-g/m3 multiplié par 10)</li>
<li>SMIN : plus petite valeur des relevés réalisés deux fois par semaine
de sulfate (micro-g/m3 multiplié par 10)</li>
<li>SMAX : plus grande valeur des relevés réalisés deux fois par semaine
de sulfate (micro-g/m3 multiplié par 10)</li>
<li>LPM2 : logarithme de la densité de la population par mile carré
(multiplié par 0,1)</li>
</ul>
<p>Lecture des données</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbertran.github.io/homepage/" class="external-link">sageR</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">)</span></span></code></pre></div>
<p>Élimine les variables <code>PM2</code> et <code>PMAX</code> qui sont
transformées en logarithme dans les variables <code>l_pm2</code> et
<code>l_pmax</code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">air_pollution</span> <span class="op">&lt;-</span> <span class="va">air_pollution</span><span class="op">[</span>,<span class="op">-</span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Quelques statistiques descriptives du fichier de données</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="co">#&gt;        CITY         TMR              SMIN            SMEAN       </span></span>
<span><span class="co">#&gt;  JACKSON : 2   Min.   : 618.0   Min.   :  1.00   Min.   : 27.00  </span></span>
<span><span class="co">#&gt;  AUGUSTA : 1   1st Qu.: 806.5   1st Qu.: 27.25   1st Qu.: 62.25  </span></span>
<span><span class="co">#&gt;  AUSTIN  : 1   Median : 882.5   Median : 43.50   Median : 79.50  </span></span>
<span><span class="co">#&gt;  BEAUMONT: 1   Mean   : 893.9   Mean   : 47.36   Mean   : 98.18  </span></span>
<span><span class="co">#&gt;  BOSTON  : 1   3rd Qu.: 955.2   3rd Qu.: 62.00   3rd Qu.:132.50  </span></span>
<span><span class="co">#&gt;  BRIDGEPO: 1   Max.   :1199.0   Max.   :155.00   Max.   :283.00  </span></span>
<span><span class="co">#&gt;  (Other) :43                                                     </span></span>
<span><span class="co">#&gt;       SMAX            PMIN           PMEAN            PERWH      </span></span>
<span><span class="co">#&gt;  Min.   : 58.0   Min.   :10.00   Min.   : 54.00   Min.   :60.00  </span></span>
<span><span class="co">#&gt;  1st Qu.:139.5   1st Qu.:29.75   1st Qu.: 90.25   1st Qu.:83.03  </span></span>
<span><span class="co">#&gt;  Median :194.5   Median :46.00   Median :121.00   Median :90.65  </span></span>
<span><span class="co">#&gt;  Mean   :220.0   Mean   :46.86   Mean   :122.48   Mean   :87.50  </span></span>
<span><span class="co">#&gt;  3rd Qu.:265.2   3rd Qu.:57.50   3rd Qu.:147.00   3rd Qu.:95.08  </span></span>
<span><span class="co">#&gt;  Max.   :940.0   Max.   :98.00   Max.   :247.00   Max.   :99.30  </span></span>
<span><span class="co">#&gt;                                                                  </span></span>
<span><span class="co">#&gt;     NONPOOR           GE65             LPOP           l_pm2      </span></span>
<span><span class="co">#&gt;  Min.   :67.80   Min.   : 45.00   Min.   :4.937   Min.   :1.808  </span></span>
<span><span class="co">#&gt;  1st Qu.:76.58   1st Qu.: 70.25   1st Qu.:5.384   1st Qu.:3.251  </span></span>
<span><span class="co">#&gt;  Median :82.65   Median : 81.50   Median :5.570   Median :3.637  </span></span>
<span><span class="co">#&gt;  Mean   :81.57   Mean   : 81.32   Mean   :5.639   Mean   :3.814  </span></span>
<span><span class="co">#&gt;  3rd Qu.:87.10   3rd Qu.: 93.75   3rd Qu.:5.831   3rd Qu.:4.398  </span></span>
<span><span class="co">#&gt;  Max.   :90.70   Max.   :116.00   Max.   :6.794   Max.   :7.213  </span></span>
<span><span class="co">#&gt;                                                                  </span></span>
<span><span class="co">#&gt;      l_pmax     </span></span>
<span><span class="co">#&gt;  Min.   :4.820  </span></span>
<span><span class="co">#&gt;  1st Qu.:5.247  </span></span>
<span><span class="co">#&gt;  Median :5.489  </span></span>
<span><span class="co">#&gt;  Mean   :5.521  </span></span>
<span><span class="co">#&gt;  3rd Qu.:5.777  </span></span>
<span><span class="co">#&gt;  Max.   :6.865  </span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exercice-10-1-analyse-des-corrélations-entre-les-variables">Exercice 10.1 : Analyse des corrélations entre les variables<a class="anchor" aria-label="anchor" href="#exercice-10-1-analyse-des-corr%C3%A9lations-entre-les-variables"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html" class="external-link">ggpairs</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'GGally':</span></span>
<span><span class="co">#&gt;   method from   </span></span>
<span><span class="co">#&gt;   +.gg   ggplot2</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor_pollution</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">col1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#7F0000"</span>, <span class="st">"red"</span>, <span class="st">"#FF7F00"</span>, <span class="st">"yellow"</span>, <span class="st">"white"</span>,</span>
<span>                           <span class="st">"cyan"</span>, <span class="st">"#007FFF"</span>, <span class="st">"blue"</span>, <span class="st">"#00007F"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#67001F"</span>, <span class="st">"#B2182B"</span>, <span class="st">"#D6604D"</span>, <span class="st">"#F4A582"</span>,</span>
<span>                           <span class="st">"#FDDBC7"</span>, <span class="st">"#FFFFFF"</span>, <span class="st">"#D1E5F0"</span>, <span class="st">"#92C5DE"</span>,</span>
<span>                           <span class="st">"#4393C3"</span>, <span class="st">"#2166AC"</span>, <span class="st">"#053061"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"white"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">col4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#7F0000"</span>, <span class="st">"red"</span>, <span class="st">"#FF7F00"</span>, <span class="st">"yellow"</span>, <span class="st">"#7FFF7F"</span>,</span>
<span>                           <span class="st">"cyan"</span>, <span class="st">"#007FFF"</span>, <span class="st">"blue"</span>, <span class="st">"#00007F"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">whiteblack</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu">corrplot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span><span class="va">cor_pollution</span>, method <span class="op">=</span> <span class="st">"color"</span>, addrect <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fu">col1</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="exercice-10-2-régression-simple">Exercice 10.2 : Régression simple<a class="anchor" aria-label="anchor" href="#exercice-10-2-r%C3%A9gression-simple"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_GE65</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">GE65</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_GE65</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ GE65, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -174.287  -39.126   -8.287   49.514  189.929 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 426.5237    50.4206   8.459 4.49e-11 ***</span></span>
<span><span class="co">#&gt; GE65          5.7469     0.6073   9.464 1.49e-12 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 71.97 on 48 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.6511, Adjusted R-squared:  0.6438 </span></span>
<span><span class="co">#&gt; F-statistic: 89.56 on 1 and 48 DF,  p-value: 1.492e-12</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_LPOP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">LPOP</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_LPOP</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ LPOP, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -265.725  -73.857   -0.878   60.211  294.585 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">#&gt; (Intercept)   489.92     254.18   1.927   0.0599 .</span></span>
<span><span class="co">#&gt; LPOP           71.64      44.98   1.593   0.1178  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 118.7 on 48 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.05019,    Adjusted R-squared:  0.0304 </span></span>
<span><span class="co">#&gt; F-statistic: 2.537 on 1 and 48 DF,  p-value: 0.1178</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_NONPOOR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">NONPOOR</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_NONPOOR</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ NONPOOR, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -253.912  -84.067   -7.787   43.187  270.812 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">#&gt; (Intercept)  405.541    212.736   1.906   0.0626 .</span></span>
<span><span class="co">#&gt; NONPOOR        5.987      2.600   2.302   0.0257 *</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 115.6 on 48 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.09944,    Adjusted R-squared:  0.08068 </span></span>
<span><span class="co">#&gt; F-statistic:   5.3 on 1 and 48 DF,  p-value: 0.0257</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_PERWH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">PERWH</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_PERWH</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ PERWH, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -307.890  -67.430    4.312   58.856  285.641 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  589.299    141.000   4.179 0.000123 ***</span></span>
<span><span class="co">#&gt; PERWH          3.481      1.600   2.175 0.034602 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 116.2 on 48 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.0897, Adjusted R-squared:  0.07074 </span></span>
<span><span class="co">#&gt; F-statistic:  4.73 on 1 and 48 DF,  p-value: 0.0346</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_PMEAN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">PMEAN</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_PMEAN</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ PMEAN, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -283.601  -82.968    0.699   58.449  298.242 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 859.4062    53.7979  15.975   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; PMEAN         0.2813     0.4163   0.676    0.502    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 121.3 on 48 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.009422,   Adjusted R-squared:  -0.01122 </span></span>
<span><span class="co">#&gt; F-statistic: 0.4565 on 1 and 48 DF,  p-value: 0.5025</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_PMIN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">PMIN</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_PMIN</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ PMIN, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -278.532  -77.940    6.705   52.070  299.172 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 835.3543    42.9612   19.44   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; PMIN          1.2485     0.8433    1.48    0.145    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 119.1 on 48 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.04367,    Adjusted R-squared:  0.02374 </span></span>
<span><span class="co">#&gt; F-statistic: 2.192 on 1 and 48 DF,  p-value: 0.1453</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_l_pmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">l_pmax</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_l_pmax</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ l_pmax, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -270.50  -86.47  -10.79   67.23  305.31 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   967.71     212.38   4.556 3.58e-05 ***</span></span>
<span><span class="co">#&gt; l_pmax        -13.38      38.34  -0.349    0.729    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 121.7 on 48 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.002529,   Adjusted R-squared:  -0.01825 </span></span>
<span><span class="co">#&gt; F-statistic: 0.1217 on 1 and 48 DF,  p-value: 0.7287</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_SMEAN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">SMEAN</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_SMEAN</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ SMEAN, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -266.672  -62.242   -0.821   57.914  278.902 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 813.1775    33.3272   24.40  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; SMEAN         0.8218     0.2977    2.76  0.00816 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 113.2 on 48 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.137,  Adjusted R-squared:  0.119 </span></span>
<span><span class="co">#&gt; F-statistic: 7.618 on 1 and 48 DF,  p-value: 0.008158</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_SMIN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">SMIN</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_SMIN</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ SMIN, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -275.271  -73.666   -1.265   68.334  239.169 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 816.3143    27.9532  29.203  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; SMIN          1.6374     0.4908   3.336  0.00165 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 109.8 on 48 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.1882, Adjusted R-squared:  0.1713 </span></span>
<span><span class="co">#&gt; F-statistic: 11.13 on 1 and 48 DF,  p-value: 0.001647</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_SMAX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">SMAX</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_SMAX</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ SMAX, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -274.103  -81.565   -1.544   57.872  288.864 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 864.0365    32.3440  26.714   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; SMAX          0.1356     0.1250   1.084    0.284    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 120.4 on 48 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.02391,    Adjusted R-squared:  0.003578 </span></span>
<span><span class="co">#&gt; F-statistic: 1.176 on 1 and 48 DF,  p-value: 0.2836</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_l_pm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">l_pm2</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_l_pm2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ l_pm2, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -250.718  -59.062   -5.373   72.194  241.352 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)   665.05      60.97  10.908 1.36e-14 ***</span></span>
<span><span class="co">#&gt; l_pm2          60.00      15.49   3.873 0.000325 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 106.3 on 48 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.2381, Adjusted R-squared:  0.2222 </span></span>
<span><span class="co">#&gt; F-statistic:    15 on 1 and 48 DF,  p-value: 0.0003254</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exercice-10-3-analyse-des-résidus-et-des-observations">Exercice 10.3 : Analyse des résidus et des observations<a class="anchor" aria-label="anchor" href="#exercice-10-3-analyse-des-r%C3%A9sidus-et-des-observations"></a>
</h2>
<p>Analyse du modèle <code>TMR</code> vs <code>GE65</code></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">GE65</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"GE65"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span>,main<span class="op">=</span><span class="st">"Evolution de TMR en fonction de GE65"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">GE65</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rstudent_leverage</span> <span class="op">&lt;-</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_prep_rstudlev_data.html" class="external-link">ols_prep_rstudlev_data</a></span><span class="op">(</span><span class="va">reg_TMR_GE65</span><span class="op">)</span></span>
<span><span class="va">rstudent</span> <span class="op">&lt;-</span> <span class="va">rstudent_leverage</span><span class="op">$</span><span class="va">levrstud</span><span class="op">$</span><span class="va">rstudent</span></span>
<span><span class="va">result_TMR_GE65</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">air_pollution</span>,<span class="va">rstudent</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">GE65</span>, <span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">rstudent</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"GE65"</span>,ylab<span class="op">=</span><span class="st">"RStudents"</span>,main<span class="op">=</span><span class="st">"Comportement des RStudents"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">GE65</span>, <span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">rstudent</span>, <span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.99</span>,<span class="fl">0</span>,<span class="fl">1.99</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leverage</span> <span class="op">&lt;-</span> <span class="va">rstudent_leverage</span><span class="op">$</span><span class="va">levrstud</span><span class="op">$</span><span class="va">leverage</span></span>
<span><span class="va">result_TMR_GE65</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_GE65</span>,<span class="va">leverage</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">GE65</span>, <span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">leverage</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"GE65"</span>,ylab<span class="op">=</span><span class="st">"Levier"</span>,main<span class="op">=</span><span class="st">"Comportement des leviers"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">GE65</span>, <span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">leverage</span>, <span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">reg_TMR_GE65</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">49</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span><span class="op">/</span><span class="fl">48</span><span class="op">)</span></span>
<span><span class="va">resid_std</span> <span class="op">&lt;-</span> <span class="va">resid</span><span class="op">/</span><span class="va">rmse</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cookd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span>
<span>    <span class="op">{</span><span class="va">cookd</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">resid_std</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">result_TMR_GE65</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_GE65</span>,<span class="va">cookd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">GE65</span>, <span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">cookd</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"GE65"</span>,ylab<span class="op">=</span><span class="st">"D de Cook"</span>,main<span class="op">=</span><span class="st">"Comportement des D de Cook"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">GE65</span>, <span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">cookd</span>, <span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<p>Analyse du modèle <code>TMR</code> vs <code>l_pm2</code></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">l_pm2</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"l_pm2"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span>,main<span class="op">=</span><span class="st">"Evolution de TMR en fonction de l_pm2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">l_pm2</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rstudent_leverage</span> <span class="op">&lt;-</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_prep_rstudlev_data.html" class="external-link">ols_prep_rstudlev_data</a></span><span class="op">(</span><span class="va">reg_TMR_l_pm2</span><span class="op">)</span></span>
<span><span class="va">rstudent</span> <span class="op">&lt;-</span> <span class="va">rstudent_leverage</span><span class="op">$</span><span class="va">levrstud</span><span class="op">$</span><span class="va">rstudent</span></span>
<span><span class="va">result_TMR_l_pm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">air_pollution</span>,<span class="va">rstudent</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">l_pm2</span>, <span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">rstudent</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"l_pm2"</span>,ylab<span class="op">=</span><span class="st">"RStudents"</span>,main<span class="op">=</span><span class="st">"Comportement des RStudents"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">l_pm2</span>, <span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">rstudent</span>, <span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.99</span>,<span class="fl">0</span>,<span class="fl">1.99</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leverage</span> <span class="op">&lt;-</span> <span class="va">rstudent_leverage</span><span class="op">$</span><span class="va">levrstud</span><span class="op">$</span><span class="va">leverage</span></span>
<span><span class="va">result_TMR_l_pm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_l_pm2</span>,<span class="va">leverage</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">l_pm2</span>, <span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">leverage</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"l_pm2"</span>,ylab<span class="op">=</span><span class="st">"Levier"</span>,main<span class="op">=</span><span class="st">"Comportement des leviers"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">l_pm2</span>, <span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">leverage</span>, <span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">reg_TMR_l_pm2</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">49</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span><span class="op">/</span><span class="fl">48</span><span class="op">)</span></span>
<span><span class="va">resid_std</span> <span class="op">&lt;-</span> <span class="va">resid</span><span class="op">/</span><span class="va">rmse</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cookd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span>
<span>    <span class="op">{</span><span class="va">cookd</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">resid_std</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">result_TMR_l_pm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_l_pm2</span>,<span class="va">cookd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">l_pm2</span>, <span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">cookd</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"l_pm2"</span>,ylab<span class="op">=</span><span class="st">"D de Cook"</span>,main<span class="op">=</span><span class="st">"Comportement des D de Cook"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">l_pm2</span>, <span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">cookd</span>, <span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<p>Analyse du modèle <code>TMR</code> vs <code>SMIN</code></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">SMIN</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"SMIN"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span>,main<span class="op">=</span><span class="st">"Evolution de TMR en fonction de SMIN"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">SMIN</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rstudent_leverage</span> <span class="op">&lt;-</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_prep_rstudlev_data.html" class="external-link">ols_prep_rstudlev_data</a></span><span class="op">(</span><span class="va">reg_TMR_SMIN</span><span class="op">)</span></span>
<span><span class="va">rstudent</span> <span class="op">&lt;-</span> <span class="va">rstudent_leverage</span><span class="op">$</span><span class="va">levrstud</span><span class="op">$</span><span class="va">rstudent</span></span>
<span><span class="va">result_TMR_SMIN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">air_pollution</span>,<span class="va">rstudent</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">SMIN</span>, <span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">rstudent</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"SMIN"</span>,ylab<span class="op">=</span><span class="st">"RStudents"</span>,main<span class="op">=</span><span class="st">"Comportement des RStudents"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">SMIN</span>, <span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">rstudent</span>, <span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.99</span>,<span class="fl">0</span>,<span class="fl">1.99</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leverage</span> <span class="op">&lt;-</span> <span class="va">rstudent_leverage</span><span class="op">$</span><span class="va">levrstud</span><span class="op">$</span><span class="va">leverage</span></span>
<span><span class="va">result_TMR_SMIN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_SMIN</span>,<span class="va">leverage</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">SMIN</span>, <span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">leverage</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"SMIN"</span>,ylab<span class="op">=</span><span class="st">"Levier"</span>,main<span class="op">=</span><span class="st">"Comportement des leviers"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">SMIN</span>, <span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">leverage</span>, <span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">reg_TMR_SMIN</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">49</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span><span class="op">/</span><span class="fl">48</span><span class="op">)</span></span>
<span><span class="va">resid_std</span> <span class="op">&lt;-</span> <span class="va">resid</span><span class="op">/</span><span class="va">rmse</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cookd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span>
<span>    <span class="op">{</span><span class="va">cookd</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">resid_std</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">result_TMR_SMIN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_SMIN</span>,<span class="va">cookd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">SMIN</span>, <span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">cookd</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"SMIN"</span>,ylab<span class="op">=</span><span class="st">"D de Cook"</span>,main<span class="op">=</span><span class="st">"Comportement des D de Cook"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">SMIN</span>, <span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">cookd</span>, <span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-32-1.png" width="700"></p>
<p>Analyse du modèle <code>TMR</code> vs <code>SMEAN</code></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">SMEAN</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"SMEAN"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span>,main<span class="op">=</span><span class="st">"Evolution de TMR en fonction de SMEAN"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">SMEAN</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rstudent_leverage</span> <span class="op">&lt;-</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_prep_rstudlev_data.html" class="external-link">ols_prep_rstudlev_data</a></span><span class="op">(</span><span class="va">reg_TMR_SMEAN</span><span class="op">)</span></span>
<span><span class="va">rstudent</span> <span class="op">&lt;-</span> <span class="va">rstudent_leverage</span><span class="op">$</span><span class="va">levrstud</span><span class="op">$</span><span class="va">rstudent</span></span>
<span><span class="va">result_TMR_SMEAN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">air_pollution</span>,<span class="va">rstudent</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">SMEAN</span>, <span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">rstudent</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"SMEAN"</span>,ylab<span class="op">=</span><span class="st">"RStudents"</span>,main<span class="op">=</span><span class="st">"Comportement des RStudents"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">SMEAN</span>, <span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">rstudent</span>, <span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.99</span>,<span class="fl">0</span>,<span class="fl">1.99</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leverage</span> <span class="op">&lt;-</span> <span class="va">rstudent_leverage</span><span class="op">$</span><span class="va">levrstud</span><span class="op">$</span><span class="va">leverage</span></span>
<span><span class="va">result_TMR_SMEAN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_SMEAN</span>,<span class="va">leverage</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">SMEAN</span>, <span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">leverage</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"SMEAN"</span>,ylab<span class="op">=</span><span class="st">"Levier"</span>,main<span class="op">=</span><span class="st">"Comportement des leviers"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">SMEAN</span>, <span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">leverage</span>, <span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">reg_TMR_SMEAN</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">49</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span><span class="op">/</span><span class="fl">48</span><span class="op">)</span></span>
<span><span class="va">resid_std</span> <span class="op">&lt;-</span> <span class="va">resid</span><span class="op">/</span><span class="va">rmse</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cookd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span>
<span>    <span class="op">{</span><span class="va">cookd</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">resid_std</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">result_TMR_SMEAN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_SMEAN</span>,<span class="va">cookd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">SMEAN</span>, <span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">cookd</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"SMEAN"</span>,ylab<span class="op">=</span><span class="st">"D de Cook"</span>,main<span class="op">=</span><span class="st">"Comportement des D de Cook"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">SMEAN</span>, <span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">cookd</span>, <span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
<p>Analyse du modèle <code>TMR</code> vs <code>NOOPOOR</code></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">NONPOOR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"NONPOOR"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span>,main<span class="op">=</span><span class="st">"Evolution de TMR en fonction de NONPOOR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">NONPOOR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-38-1.png" width="700"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rstudent_leverage</span> <span class="op">&lt;-</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_prep_rstudlev_data.html" class="external-link">ols_prep_rstudlev_data</a></span><span class="op">(</span><span class="va">reg_TMR_NONPOOR</span><span class="op">)</span></span>
<span><span class="va">rstudent</span> <span class="op">&lt;-</span> <span class="va">rstudent_leverage</span><span class="op">$</span><span class="va">levrstud</span><span class="op">$</span><span class="va">rstudent</span></span>
<span><span class="va">result_TMR_NONPOOR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">air_pollution</span>,<span class="va">rstudent</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">NONPOOR</span>, <span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">rstudent</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"NONPOOR"</span>,ylab<span class="op">=</span><span class="st">"RStudents"</span>,main<span class="op">=</span><span class="st">"Comportement des RStudents"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">NONPOOR</span>, <span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">rstudent</span>, <span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.99</span>,<span class="fl">0</span>,<span class="fl">1.99</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-39-1.png" width="700"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leverage</span> <span class="op">&lt;-</span> <span class="va">rstudent_leverage</span><span class="op">$</span><span class="va">levrstud</span><span class="op">$</span><span class="va">leverage</span></span>
<span><span class="va">result_TMR_NONPOOR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_NONPOOR</span>,<span class="va">leverage</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">NONPOOR</span>, <span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">leverage</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"NONPOOR"</span>,ylab<span class="op">=</span><span class="st">"Levier"</span>,main<span class="op">=</span><span class="st">"Comportement des leviers"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">NONPOOR</span>, <span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">leverage</span>, <span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-40-1.png" width="700"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">reg_TMR_NONPOOR</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">49</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span><span class="op">/</span><span class="fl">48</span><span class="op">)</span></span>
<span><span class="va">resid_std</span> <span class="op">&lt;-</span> <span class="va">resid</span><span class="op">/</span><span class="va">rmse</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cookd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span>
<span>    <span class="op">{</span><span class="va">cookd</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">resid_std</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">result_TMR_NONPOOR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_NONPOOR</span>,<span class="va">cookd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">NONPOOR</span>, <span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">cookd</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"NONPOOR"</span>,ylab<span class="op">=</span><span class="st">"D de Cook"</span>,main<span class="op">=</span><span class="st">"Comportement des D de Cook"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">NONPOOR</span>, <span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">cookd</span>, <span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-42-1.png" width="700"></p>
<p>Analyse du modèle <code>TMR</code> vs <code>PERWH</code></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">PERWH</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"PERWH"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span>,main<span class="op">=</span><span class="st">"Evolution de TMR en fonction de PERWH"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">PERWH</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-43-1.png" width="700"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rstudent_leverage</span> <span class="op">&lt;-</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_prep_rstudlev_data.html" class="external-link">ols_prep_rstudlev_data</a></span><span class="op">(</span><span class="va">reg_TMR_PERWH</span><span class="op">)</span></span>
<span><span class="va">rstudent</span> <span class="op">&lt;-</span> <span class="va">rstudent_leverage</span><span class="op">$</span><span class="va">levrstud</span><span class="op">$</span><span class="va">rstudent</span></span>
<span><span class="va">result_TMR_PERWH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">air_pollution</span>,<span class="va">rstudent</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">PERWH</span>, <span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">rstudent</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"PERWH"</span>,ylab<span class="op">=</span><span class="st">"RStudents"</span>,main<span class="op">=</span><span class="st">"Comportement des RStudents"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">PERWH</span>, <span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">rstudent</span>, <span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.99</span>,<span class="fl">0</span>,<span class="fl">1.99</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-44-1.png" width="700"></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leverage</span> <span class="op">&lt;-</span> <span class="va">rstudent_leverage</span><span class="op">$</span><span class="va">levrstud</span><span class="op">$</span><span class="va">leverage</span></span>
<span><span class="va">result_TMR_PERWH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_PERWH</span>,<span class="va">leverage</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">PERWH</span>, <span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">leverage</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"PERWH"</span>,ylab<span class="op">=</span><span class="st">"Levier"</span>,main<span class="op">=</span><span class="st">"Comportement des leviers"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">PERWH</span>, <span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">leverage</span>, <span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-45-1.png" width="700"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">reg_TMR_PERWH</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">49</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span><span class="op">/</span><span class="fl">48</span><span class="op">)</span></span>
<span><span class="va">resid_std</span> <span class="op">&lt;-</span> <span class="va">resid</span><span class="op">/</span><span class="va">rmse</span></span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cookd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span>
<span>    <span class="op">{</span><span class="va">cookd</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">resid_std</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">result_TMR_PERWH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_PERWH</span>,<span class="va">cookd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">PERWH</span>, <span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">cookd</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"PERWH"</span>,ylab<span class="op">=</span><span class="st">"D de Cook"</span>,main<span class="op">=</span><span class="st">"Comportement des D de Cook"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">PERWH</span>, <span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">cookd</span>, <span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.08</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-47-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="exercices-10-4-intervalles-de-confiance-et-de-prévision">Exercices 10.4 : Intervalles de confiance et de prévision<a class="anchor" aria-label="anchor" href="#exercices-10-4-intervalles-de-confiance-et-de-pr%C3%A9vision"></a>
</h2>
<p>Analyse du modèle <code>TMR</code> vs <code>GE65</code></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IC_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reg_TMR_GE65</span>, interval<span class="op">=</span><span class="st">"confidence"</span><span class="op">)</span></span>
<span><span class="va">IC_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">IC_95</span><span class="op">)</span></span>
<span><span class="va">binf_IC_95</span> <span class="op">&lt;-</span> <span class="va">IC_95</span><span class="op">$</span><span class="va">lwr</span></span>
<span><span class="va">bsup_IC_95</span> <span class="op">&lt;-</span> <span class="va">IC_95</span><span class="op">$</span><span class="va">upr</span></span>
<span><span class="va">result_TMR_GE65</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">air_pollution</span>,<span class="va">binf_IC_95</span>,<span class="va">bsup_IC_95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">GE65</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"p"</span>,xlab<span class="op">=</span><span class="st">"GE65"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">reg_TMR_GE65</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span><span class="va">result_TMR_GE65</span><span class="op">$</span><span class="va">GE65</span>,<span class="va">IC_95</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-48-1.png" width="700"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IP_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reg_TMR_GE65</span>, interval<span class="op">=</span><span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in predict.lm(reg_TMR_GE65, interval = "prediction"): predictions on current data refer to _future_ responses</span></span>
<span><span class="va">IP_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">IP_95</span><span class="op">)</span></span>
<span><span class="va">binf_IP_95</span> <span class="op">&lt;-</span> <span class="va">IP_95</span><span class="op">$</span><span class="va">lwr</span></span>
<span><span class="va">bsup_IP_95</span> <span class="op">&lt;-</span> <span class="va">IP_95</span><span class="op">$</span><span class="va">upr</span></span>
<span><span class="va">result_TMR_GE65</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_GE65</span>,<span class="va">binf_IP_95</span>,<span class="va">bsup_IP_95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">GE65</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"GE65"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">GE65</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">reg_TMR_GE65</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">GE65</span>,<span class="va">IP_95</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-49-1.png" width="700"></p>
<p>Analyse du modèle <code>TMR</code> vs <code>l_pm2</code></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IC_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reg_TMR_l_pm2</span>, interval<span class="op">=</span><span class="st">"confidence"</span><span class="op">)</span></span>
<span><span class="va">IC_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">IC_95</span><span class="op">)</span></span>
<span><span class="va">binf_IC_95</span> <span class="op">&lt;-</span> <span class="va">IC_95</span><span class="op">$</span><span class="va">lwr</span></span>
<span><span class="va">bsup_IC_95</span> <span class="op">&lt;-</span> <span class="va">IC_95</span><span class="op">$</span><span class="va">upr</span></span>
<span><span class="va">result_TMR_l_pm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">air_pollution</span>,<span class="va">binf_IC_95</span>,<span class="va">bsup_IC_95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">l_pm2</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"p"</span>,xlab<span class="op">=</span><span class="st">"l_pm2"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">reg_TMR_l_pm2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span><span class="va">result_TMR_l_pm2</span><span class="op">$</span><span class="va">l_pm2</span>,<span class="va">IC_95</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-50-1.png" width="700"></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IP_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reg_TMR_l_pm2</span>, interval<span class="op">=</span><span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in predict.lm(reg_TMR_l_pm2, interval = "prediction"): predictions on current data refer to _future_ responses</span></span>
<span><span class="va">IP_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">IP_95</span><span class="op">)</span></span>
<span><span class="va">binf_IP_95</span> <span class="op">&lt;-</span> <span class="va">IP_95</span><span class="op">$</span><span class="va">lwr</span></span>
<span><span class="va">bsup_IP_95</span> <span class="op">&lt;-</span> <span class="va">IP_95</span><span class="op">$</span><span class="va">upr</span></span>
<span><span class="va">result_TMR_l_pm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_l_pm2</span>,<span class="va">binf_IP_95</span>,<span class="va">bsup_IP_95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">l_pm2</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"l_pm2"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">l_pm2</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">reg_TMR_l_pm2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">l_pm2</span>,<span class="va">IP_95</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-51-1.png" width="700"></p>
<p>Analyse du modèle <code>TMR</code> vs <code>SMIN</code></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IC_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reg_TMR_SMIN</span>, interval<span class="op">=</span><span class="st">"confidence"</span><span class="op">)</span></span>
<span><span class="va">IC_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">IC_95</span><span class="op">)</span></span>
<span><span class="va">binf_IC_95</span> <span class="op">&lt;-</span> <span class="va">IC_95</span><span class="op">$</span><span class="va">lwr</span></span>
<span><span class="va">bsup_IC_95</span> <span class="op">&lt;-</span> <span class="va">IC_95</span><span class="op">$</span><span class="va">upr</span></span>
<span><span class="va">result_TMR_SMIN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">air_pollution</span>,<span class="va">binf_IC_95</span>,<span class="va">bsup_IC_95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">SMIN</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"p"</span>,xlab<span class="op">=</span><span class="st">"SMIN"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">reg_TMR_SMIN</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span><span class="va">result_TMR_SMIN</span><span class="op">$</span><span class="va">SMIN</span>,<span class="va">IC_95</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-52-1.png" width="700"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IP_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reg_TMR_SMIN</span>, interval<span class="op">=</span><span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in predict.lm(reg_TMR_SMIN, interval = "prediction"): predictions on current data refer to _future_ responses</span></span>
<span><span class="va">IP_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">IP_95</span><span class="op">)</span></span>
<span><span class="va">binf_IP_95</span> <span class="op">&lt;-</span> <span class="va">IP_95</span><span class="op">$</span><span class="va">lwr</span></span>
<span><span class="va">bsup_IP_95</span> <span class="op">&lt;-</span> <span class="va">IP_95</span><span class="op">$</span><span class="va">upr</span></span>
<span><span class="va">result_TMR_SMIN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_SMIN</span>,<span class="va">binf_IP_95</span>,<span class="va">bsup_IP_95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">SMIN</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"SMIN"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">SMIN</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">reg_TMR_SMIN</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">SMIN</span>,<span class="va">IP_95</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-53-1.png" width="700"></p>
<p>Analyse du modèle <code>TMR</code> vs <code>SMEAN</code></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IC_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reg_TMR_SMEAN</span>, interval<span class="op">=</span><span class="st">"confidence"</span><span class="op">)</span></span>
<span><span class="va">IC_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">IC_95</span><span class="op">)</span></span>
<span><span class="va">binf_IC_95</span> <span class="op">&lt;-</span> <span class="va">IC_95</span><span class="op">$</span><span class="va">lwr</span></span>
<span><span class="va">bsup_IC_95</span> <span class="op">&lt;-</span> <span class="va">IC_95</span><span class="op">$</span><span class="va">upr</span></span>
<span><span class="va">result_TMR_SMEAN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">air_pollution</span>,<span class="va">binf_IC_95</span>,<span class="va">bsup_IC_95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">SMEAN</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"p"</span>,xlab<span class="op">=</span><span class="st">"SMEAN"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">reg_TMR_SMEAN</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span><span class="va">result_TMR_SMEAN</span><span class="op">$</span><span class="va">SMEAN</span>,<span class="va">IC_95</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-54-1.png" width="700"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IP_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reg_TMR_SMEAN</span>, interval<span class="op">=</span><span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in predict.lm(reg_TMR_SMEAN, interval = "prediction"): predictions on current data refer to _future_ responses</span></span>
<span><span class="va">IP_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">IP_95</span><span class="op">)</span></span>
<span><span class="va">binf_IP_95</span> <span class="op">&lt;-</span> <span class="va">IP_95</span><span class="op">$</span><span class="va">lwr</span></span>
<span><span class="va">bsup_IP_95</span> <span class="op">&lt;-</span> <span class="va">IP_95</span><span class="op">$</span><span class="va">upr</span></span>
<span><span class="va">result_TMR_SMEAN</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_SMEAN</span>,<span class="va">binf_IP_95</span>,<span class="va">bsup_IP_95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">SMEAN</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"SMEAN"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">SMEAN</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">reg_TMR_SMEAN</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">SMEAN</span>,<span class="va">IP_95</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-55-1.png" width="700"></p>
<p>Analyse du modèle <code>TMR</code> vs <code>NONPOOR</code></p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IC_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reg_TMR_NONPOOR</span>, interval<span class="op">=</span><span class="st">"confidence"</span><span class="op">)</span></span>
<span><span class="va">IC_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">IC_95</span><span class="op">)</span></span>
<span><span class="va">binf_IC_95</span> <span class="op">&lt;-</span> <span class="va">IC_95</span><span class="op">$</span><span class="va">lwr</span></span>
<span><span class="va">bsup_IC_95</span> <span class="op">&lt;-</span> <span class="va">IC_95</span><span class="op">$</span><span class="va">upr</span></span>
<span><span class="va">result_TMR_NONPOOR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">air_pollution</span>,<span class="va">binf_IC_95</span>,<span class="va">bsup_IC_95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">NONPOOR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"p"</span>,xlab<span class="op">=</span><span class="st">"NONPOOR"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">reg_TMR_NONPOOR</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span><span class="va">result_TMR_NONPOOR</span><span class="op">$</span><span class="va">NONPOOR</span>,<span class="va">IC_95</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-56-1.png" width="700"></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IP_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reg_TMR_NONPOOR</span>, interval<span class="op">=</span><span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in predict.lm(reg_TMR_NONPOOR, interval = "prediction"): predictions on current data refer to _future_ responses</span></span>
<span><span class="va">IP_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">IP_95</span><span class="op">)</span></span>
<span><span class="va">binf_IP_95</span> <span class="op">&lt;-</span> <span class="va">IP_95</span><span class="op">$</span><span class="va">lwr</span></span>
<span><span class="va">bsup_IP_95</span> <span class="op">&lt;-</span> <span class="va">IP_95</span><span class="op">$</span><span class="va">upr</span></span>
<span><span class="va">result_TMR_NONPOOR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_NONPOOR</span>,<span class="va">binf_IP_95</span>,<span class="va">bsup_IP_95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">NONPOOR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"NONPOOR"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">NONPOOR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">reg_TMR_NONPOOR</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">NONPOOR</span>,<span class="va">IP_95</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-57-1.png" width="700"></p>
<p>Analyse du modèle <code>TMR</code> vs <code>PERWH</code></p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IC_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reg_TMR_PERWH</span>, interval<span class="op">=</span><span class="st">"confidence"</span><span class="op">)</span></span>
<span><span class="va">IC_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">IC_95</span><span class="op">)</span></span>
<span><span class="va">binf_IC_95</span> <span class="op">&lt;-</span> <span class="va">IC_95</span><span class="op">$</span><span class="va">lwr</span></span>
<span><span class="va">bsup_IC_95</span> <span class="op">&lt;-</span> <span class="va">IC_95</span><span class="op">$</span><span class="va">upr</span></span>
<span><span class="va">result_TMR_PERWH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">air_pollution</span>,<span class="va">binf_IC_95</span>,<span class="va">bsup_IC_95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">PERWH</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"p"</span>,xlab<span class="op">=</span><span class="st">"PERWH"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">reg_TMR_PERWH</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span><span class="va">result_TMR_PERWH</span><span class="op">$</span><span class="va">PERWH</span>,<span class="va">IC_95</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-58-1.png" width="700"></p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IP_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reg_TMR_PERWH</span>, interval<span class="op">=</span><span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in predict.lm(reg_TMR_PERWH, interval = "prediction"): predictions on current data refer to _future_ responses</span></span>
<span><span class="va">IP_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">IP_95</span><span class="op">)</span></span>
<span><span class="va">binf_IP_95</span> <span class="op">&lt;-</span> <span class="va">IP_95</span><span class="op">$</span><span class="va">lwr</span></span>
<span><span class="va">bsup_IP_95</span> <span class="op">&lt;-</span> <span class="va">IP_95</span><span class="op">$</span><span class="va">upr</span></span>
<span><span class="va">result_TMR_PERWH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_PERWH</span>,<span class="va">binf_IP_95</span>,<span class="va">bsup_IP_95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">PERWH</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"PERWH"</span>,ylab<span class="op">=</span><span class="st">"TMR"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">PERWH</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="va">reg_TMR_PERWH</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">PERWH</span>,<span class="va">IP_95</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-59-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="exercice-10-5-régression-multiple">Exercice 10.5 : Régression multiple<a class="anchor" aria-label="anchor" href="#exercice-10-5-r%C3%A9gression-multiple"></a>
</h2>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">SMIN</span><span class="op">+</span><span class="va">SMEAN</span><span class="op">+</span><span class="va">SMAX</span><span class="op">+</span><span class="va">PMIN</span><span class="op">+</span><span class="va">PMEAN</span><span class="op">+</span><span class="va">PERWH</span><span class="op">+</span><span class="va">NONPOOR</span><span class="op">+</span><span class="va">GE65</span><span class="op">+</span><span class="va">LPOP</span><span class="op">+</span><span class="va">l_pm2</span><span class="op">+</span><span class="va">l_pmax</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_all</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ SMIN + SMEAN + SMAX + PMIN + PMEAN + PERWH + </span></span>
<span><span class="co">#&gt;     NONPOOR + GE65 + LPOP + l_pm2 + l_pmax, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -123.570  -23.858    4.477   32.310  104.264 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 601.67911  243.89675   2.467   0.0182 *  </span></span>
<span><span class="co">#&gt; SMIN          0.39119    0.36334   1.077   0.2884    </span></span>
<span><span class="co">#&gt; SMEAN        -0.21686    0.45596  -0.476   0.6371    </span></span>
<span><span class="co">#&gt; SMAX          0.07739    0.14112   0.548   0.5866    </span></span>
<span><span class="co">#&gt; PMIN          1.10963    0.76616   1.448   0.1557    </span></span>
<span><span class="co">#&gt; PMEAN        -0.40629    0.58083  -0.699   0.4885    </span></span>
<span><span class="co">#&gt; PERWH        -3.13718    1.41835  -2.212   0.0331 *  </span></span>
<span><span class="co">#&gt; NONPOOR      -3.21879    2.08732  -1.542   0.1313    </span></span>
<span><span class="co">#&gt; GE65          7.15451    0.67558  10.590 6.77e-13 ***</span></span>
<span><span class="co">#&gt; LPOP        -24.30248   27.95434  -0.869   0.3901    </span></span>
<span><span class="co">#&gt; l_pm2        36.78162   16.01267   2.297   0.0272 *  </span></span>
<span><span class="co">#&gt; l_pmax       41.24149   36.44439   1.132   0.2649    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 53.91 on 38 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.845,  Adjusted R-squared:  0.8001 </span></span>
<span><span class="co">#&gt; F-statistic: 18.83 on 11 and 38 DF,  p-value: 3.998e-12</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exercice-10-6-régression-simplifié">Exercice 10.6 : Régression simplifié<a class="anchor" aria-label="anchor" href="#exercice-10-6-r%C3%A9gression-simplifi%C3%A9"></a>
</h2>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_simplifie</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">PERWH</span><span class="op">+</span><span class="va">GE65</span><span class="op">+</span><span class="va">l_pm2</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_simplifie</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ PERWH + GE65 + l_pm2, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -146.219  -29.145    3.364   29.679  126.272 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 560.0295    77.3237   7.243 3.95e-09 ***</span></span>
<span><span class="co">#&gt; PERWH        -3.8830     1.0515  -3.693 0.000587 ***</span></span>
<span><span class="co">#&gt; GE65          6.8760     0.6657  10.329 1.44e-13 ***</span></span>
<span><span class="co">#&gt; l_pm2        30.0058     8.6584   3.466 0.001157 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 55.94 on 46 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.798,  Adjusted R-squared:  0.7848 </span></span>
<span><span class="co">#&gt; F-statistic: 60.56 on 3 and 46 DF,  p-value: 5.232e-16</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exercice-10-7-régression-multiple-par-sélection-de-variables">Exercice 10.7 : Régression multiple par sélection de variables<a class="anchor" aria-label="anchor" href="#exercice-10-7-r%C3%A9gression-multiple-par-s%C3%A9lection-de-variables"></a>
</h2>
<p>Définir la graine aléatoire pour pouvoir reproduire les
simulations</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></code></pre></div>
<p>Mise en place de la validation croisée <span class="math inline">\(k\)</span>-fold</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">train.control</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">trainControl</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"cv"</span>, number <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>Sélection ascendante</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">step.model</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">SMIN</span><span class="op">+</span><span class="va">SMEAN</span><span class="op">+</span><span class="va">SMAX</span><span class="op">+</span><span class="va">PMIN</span><span class="op">+</span><span class="va">PMEAN</span><span class="op">+</span><span class="va">PERWH</span><span class="op">+</span><span class="va">NONPOOR</span><span class="op">+</span><span class="va">GE65</span><span class="op">+</span><span class="va">LPOP</span><span class="op">+</span><span class="va">l_pm2</span><span class="op">+</span><span class="va">l_pmax</span>,data<span class="op">=</span><span class="va">air_pollution</span>,method <span class="op">=</span> <span class="st">"leapForward"</span>, tuneGrid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>nvmax <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, trControl <span class="op">=</span> <span class="va">train.control</span><span class="op">)</span></span>
<span><span class="va">step.model</span><span class="op">$</span><span class="va">results</span></span>
<span><span class="co">#&gt;   nvmax     RMSE  Rsquared      MAE   RMSESD RsquaredSD    MAESD</span></span>
<span><span class="co">#&gt; 1     1 69.18548 0.6759393 56.67012 21.96414 0.18841443 16.08476</span></span>
<span><span class="co">#&gt; 2     2 65.10777 0.7115294 47.56491 20.32729 0.13930059 14.28262</span></span>
<span><span class="co">#&gt; 3     3 59.58531 0.7737680 47.64129 13.08864 0.09672402 11.05144</span></span>
<span><span class="co">#&gt; 4     4 63.39414 0.7345135 51.43794 15.85645 0.14911173 15.58864</span></span>
<span><span class="co">#&gt; 5     5 59.80585 0.7610921 48.97589 17.25668 0.15858671 13.81363</span></span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">step.model</span><span class="op">$</span><span class="va">bestTune</span></span>
<span><span class="co">#&gt;   nvmax</span></span>
<span><span class="co">#&gt; 3     3</span></span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">step.model</span><span class="op">$</span><span class="va">finalModel</span><span class="op">)</span></span>
<span><span class="co">#&gt; Subset selection object</span></span>
<span><span class="co">#&gt; 11 Variables  (and intercept)</span></span>
<span><span class="co">#&gt;         Forced in Forced out</span></span>
<span><span class="co">#&gt; SMIN        FALSE      FALSE</span></span>
<span><span class="co">#&gt; SMEAN       FALSE      FALSE</span></span>
<span><span class="co">#&gt; SMAX        FALSE      FALSE</span></span>
<span><span class="co">#&gt; PMIN        FALSE      FALSE</span></span>
<span><span class="co">#&gt; PMEAN       FALSE      FALSE</span></span>
<span><span class="co">#&gt; PERWH       FALSE      FALSE</span></span>
<span><span class="co">#&gt; NONPOOR     FALSE      FALSE</span></span>
<span><span class="co">#&gt; GE65        FALSE      FALSE</span></span>
<span><span class="co">#&gt; LPOP        FALSE      FALSE</span></span>
<span><span class="co">#&gt; l_pm2       FALSE      FALSE</span></span>
<span><span class="co">#&gt; l_pmax      FALSE      FALSE</span></span>
<span><span class="co">#&gt; 1 subsets of each size up to 3</span></span>
<span><span class="co">#&gt; Selection Algorithm: forward</span></span>
<span><span class="co">#&gt;          SMIN SMEAN SMAX PMIN PMEAN PERWH NONPOOR GE65 LPOP l_pm2 l_pmax</span></span>
<span><span class="co">#&gt; 1  ( 1 ) " "  " "   " "  " "  " "   " "   " "     "*"  " "  " "   " "   </span></span>
<span><span class="co">#&gt; 2  ( 1 ) " "  " "   " "  " "  " "   "*"   " "     "*"  " "  " "   " "   </span></span>
<span><span class="co">#&gt; 3  ( 1 ) " "  " "   " "  " "  " "   "*"   " "     "*"  " "  "*"   " "</span></span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_forward</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">PERWH</span><span class="op">+</span><span class="va">GE65</span><span class="op">+</span><span class="va">l_pm2</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_forward</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ PERWH + GE65 + l_pm2, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -146.219  -29.145    3.364   29.679  126.272 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 560.0295    77.3237   7.243 3.95e-09 ***</span></span>
<span><span class="co">#&gt; PERWH        -3.8830     1.0515  -3.693 0.000587 ***</span></span>
<span><span class="co">#&gt; GE65          6.8760     0.6657  10.329 1.44e-13 ***</span></span>
<span><span class="co">#&gt; l_pm2        30.0058     8.6584   3.466 0.001157 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 55.94 on 46 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.798,  Adjusted R-squared:  0.7848 </span></span>
<span><span class="co">#&gt; F-statistic: 60.56 on 3 and 46 DF,  p-value: 5.232e-16</span></span></code></pre></div>
<p>Sélection descendante</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">step.model</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">SMIN</span><span class="op">+</span><span class="va">SMEAN</span><span class="op">+</span><span class="va">SMAX</span><span class="op">+</span><span class="va">PMIN</span><span class="op">+</span><span class="va">PMEAN</span><span class="op">+</span><span class="va">PERWH</span><span class="op">+</span><span class="va">NONPOOR</span><span class="op">+</span><span class="va">GE65</span><span class="op">+</span><span class="va">LPOP</span><span class="op">+</span><span class="va">l_pm2</span><span class="op">+</span><span class="va">l_pmax</span>,data<span class="op">=</span><span class="va">air_pollution</span>, method <span class="op">=</span> <span class="st">"leapBackward"</span>, tuneGrid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>nvmax <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, trControl <span class="op">=</span> <span class="va">train.control</span><span class="op">)</span></span>
<span><span class="va">step.model</span><span class="op">$</span><span class="va">results</span></span>
<span><span class="co">#&gt;   nvmax     RMSE  Rsquared      MAE   RMSESD RsquaredSD    MAESD</span></span>
<span><span class="co">#&gt; 1     1 70.09854 0.6630928 58.32681 26.56512  0.3333468 18.82932</span></span>
<span><span class="co">#&gt; 2     2 70.79554 0.6879672 59.56725 33.02547  0.3136828 29.16886</span></span>
<span><span class="co">#&gt; 3     3 60.04721 0.7486923 50.28272 28.11412  0.2589395 24.67720</span></span>
<span><span class="co">#&gt; 4     4 63.88906 0.7018427 53.05051 25.87602  0.3000792 22.71978</span></span>
<span><span class="co">#&gt; 5     5 66.69164 0.6917069 53.66172 22.19340  0.2961117 21.90087</span></span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">step.model</span><span class="op">$</span><span class="va">bestTune</span></span>
<span><span class="co">#&gt;   nvmax</span></span>
<span><span class="co">#&gt; 3     3</span></span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">step.model</span><span class="op">$</span><span class="va">finalModel</span><span class="op">)</span></span>
<span><span class="co">#&gt; Subset selection object</span></span>
<span><span class="co">#&gt; 11 Variables  (and intercept)</span></span>
<span><span class="co">#&gt;         Forced in Forced out</span></span>
<span><span class="co">#&gt; SMIN        FALSE      FALSE</span></span>
<span><span class="co">#&gt; SMEAN       FALSE      FALSE</span></span>
<span><span class="co">#&gt; SMAX        FALSE      FALSE</span></span>
<span><span class="co">#&gt; PMIN        FALSE      FALSE</span></span>
<span><span class="co">#&gt; PMEAN       FALSE      FALSE</span></span>
<span><span class="co">#&gt; PERWH       FALSE      FALSE</span></span>
<span><span class="co">#&gt; NONPOOR     FALSE      FALSE</span></span>
<span><span class="co">#&gt; GE65        FALSE      FALSE</span></span>
<span><span class="co">#&gt; LPOP        FALSE      FALSE</span></span>
<span><span class="co">#&gt; l_pm2       FALSE      FALSE</span></span>
<span><span class="co">#&gt; l_pmax      FALSE      FALSE</span></span>
<span><span class="co">#&gt; 1 subsets of each size up to 3</span></span>
<span><span class="co">#&gt; Selection Algorithm: backward</span></span>
<span><span class="co">#&gt;          SMIN SMEAN SMAX PMIN PMEAN PERWH NONPOOR GE65 LPOP l_pm2 l_pmax</span></span>
<span><span class="co">#&gt; 1  ( 1 ) " "  " "   " "  " "  " "   " "   " "     "*"  " "  " "   " "   </span></span>
<span><span class="co">#&gt; 2  ( 1 ) " "  " "   " "  " "  " "   " "   " "     "*"  " "  "*"   " "   </span></span>
<span><span class="co">#&gt; 3  ( 1 ) " "  " "   " "  " "  " "   " "   "*"     "*"  " "  "*"   " "</span></span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_backward</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">NONPOOR</span><span class="op">+</span><span class="va">GE65</span><span class="op">+</span><span class="va">l_pm2</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_backward</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ NONPOOR + GE65 + l_pm2, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -170.356  -28.518    3.817   30.665  142.149 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 685.4547   105.3949   6.504 5.07e-08 ***</span></span>
<span><span class="co">#&gt; NONPOOR      -5.9609     1.5899  -3.749 0.000494 ***</span></span>
<span><span class="co">#&gt; GE65          6.1259     0.5447  11.246 8.55e-15 ***</span></span>
<span><span class="co">#&gt; l_pm2        51.5150     9.1878   5.607 1.12e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 55.74 on 46 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.7994, Adjusted R-squared:  0.7863 </span></span>
<span><span class="co">#&gt; F-statistic: 61.09 on 3 and 46 DF,  p-value: 4.455e-16</span></span></code></pre></div>
<p>Sélection pas à pas</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">step.model</span> <span class="op">&lt;-</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">SMIN</span><span class="op">+</span><span class="va">SMEAN</span><span class="op">+</span><span class="va">SMAX</span><span class="op">+</span><span class="va">PMIN</span><span class="op">+</span><span class="va">PMEAN</span><span class="op">+</span><span class="va">PERWH</span><span class="op">+</span><span class="va">NONPOOR</span><span class="op">+</span><span class="va">GE65</span><span class="op">+</span><span class="va">LPOP</span><span class="op">+</span><span class="va">l_pm2</span><span class="op">+</span><span class="va">l_pmax</span>,data<span class="op">=</span><span class="va">air_pollution</span>, method <span class="op">=</span> <span class="st">"leapSeq"</span>,tuneGrid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>nvmax <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, trControl <span class="op">=</span> <span class="va">train.control</span><span class="op">)</span></span>
<span><span class="va">step.model</span><span class="op">$</span><span class="va">results</span></span>
<span><span class="co">#&gt;   nvmax     RMSE  Rsquared      MAE   RMSESD RsquaredSD    MAESD</span></span>
<span><span class="co">#&gt; 1     1 65.32693 0.7683791 55.80282 29.65039  0.2515142 24.60868</span></span>
<span><span class="co">#&gt; 2     2 68.55816 0.7503571 53.88524 21.35529  0.2029516 16.01007</span></span>
<span><span class="co">#&gt; 3     3 63.78007 0.7537507 50.13378 21.31510  0.1752168 17.63727</span></span>
<span><span class="co">#&gt; 4     4 68.42619 0.7092096 58.30839 32.09439  0.2530411 31.49394</span></span>
<span><span class="co">#&gt; 5     5 85.12890 0.6197462 68.70314 36.71849  0.2816074 25.49105</span></span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">step.model</span><span class="op">$</span><span class="va">bestTune</span></span>
<span><span class="co">#&gt;   nvmax</span></span>
<span><span class="co">#&gt; 3     3</span></span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">step.model</span><span class="op">$</span><span class="va">finalModel</span><span class="op">)</span></span>
<span><span class="co">#&gt; Subset selection object</span></span>
<span><span class="co">#&gt; 11 Variables  (and intercept)</span></span>
<span><span class="co">#&gt;         Forced in Forced out</span></span>
<span><span class="co">#&gt; SMIN        FALSE      FALSE</span></span>
<span><span class="co">#&gt; SMEAN       FALSE      FALSE</span></span>
<span><span class="co">#&gt; SMAX        FALSE      FALSE</span></span>
<span><span class="co">#&gt; PMIN        FALSE      FALSE</span></span>
<span><span class="co">#&gt; PMEAN       FALSE      FALSE</span></span>
<span><span class="co">#&gt; PERWH       FALSE      FALSE</span></span>
<span><span class="co">#&gt; NONPOOR     FALSE      FALSE</span></span>
<span><span class="co">#&gt; GE65        FALSE      FALSE</span></span>
<span><span class="co">#&gt; LPOP        FALSE      FALSE</span></span>
<span><span class="co">#&gt; l_pm2       FALSE      FALSE</span></span>
<span><span class="co">#&gt; l_pmax      FALSE      FALSE</span></span>
<span><span class="co">#&gt; 1 subsets of each size up to 3</span></span>
<span><span class="co">#&gt; Selection Algorithm: 'sequential replacement'</span></span>
<span><span class="co">#&gt;          SMIN SMEAN SMAX PMIN PMEAN PERWH NONPOOR GE65 LPOP l_pm2 l_pmax</span></span>
<span><span class="co">#&gt; 1  ( 1 ) " "  " "   " "  " "  " "   " "   " "     "*"  " "  " "   " "   </span></span>
<span><span class="co">#&gt; 2  ( 1 ) " "  " "   " "  " "  " "   "*"   " "     "*"  " "  " "   " "   </span></span>
<span><span class="co">#&gt; 3  ( 1 ) " "  " "   " "  " "  " "   " "   "*"     "*"  " "  "*"   " "</span></span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_step_by_step</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">NONPOOR</span><span class="op">+</span><span class="va">GE65</span><span class="op">+</span><span class="va">l_pm2</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_step_by_step</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ NONPOOR + GE65 + l_pm2, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -170.356  -28.518    3.817   30.665  142.149 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 685.4547   105.3949   6.504 5.07e-08 ***</span></span>
<span><span class="co">#&gt; NONPOOR      -5.9609     1.5899  -3.749 0.000494 ***</span></span>
<span><span class="co">#&gt; GE65          6.1259     0.5447  11.246 8.55e-15 ***</span></span>
<span><span class="co">#&gt; l_pm2        51.5150     9.1878   5.607 1.12e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 55.74 on 46 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.7994, Adjusted R-squared:  0.7863 </span></span>
<span><span class="co">#&gt; F-statistic: 61.09 on 3 and 46 DF,  p-value: 4.455e-16</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exercice-10-8-analyse-des-résidus-et-des-observations">Exercice 10.8 : Analyse des résidus et des observations<a class="anchor" aria-label="anchor" href="#exercice-10-8-analyse-des-r%C3%A9sidus-et-des-observations"></a>
</h2>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reg_TMR_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">TMR</span><span class="op">~</span><span class="va">PERWH</span><span class="op">+</span><span class="va">GE65</span><span class="op">+</span><span class="va">l_pm2</span>,data<span class="op">=</span><span class="va">air_pollution</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">reg_TMR_sel</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = TMR ~ PERWH + GE65 + l_pm2, data = air_pollution)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -146.219  -29.145    3.364   29.679  126.272 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) 560.0295    77.3237   7.243 3.95e-09 ***</span></span>
<span><span class="co">#&gt; PERWH        -3.8830     1.0515  -3.693 0.000587 ***</span></span>
<span><span class="co">#&gt; GE65          6.8760     0.6657  10.329 1.44e-13 ***</span></span>
<span><span class="co">#&gt; l_pm2        30.0058     8.6584   3.466 0.001157 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 55.94 on 46 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.798,  Adjusted R-squared:  0.7848 </span></span>
<span><span class="co">#&gt; F-statistic: 60.56 on 3 and 46 DF,  p-value: 5.232e-16</span></span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">reg_TMR_sel</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">reg_TMR_sel</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">49</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span><span class="op">/</span><span class="fl">46</span><span class="op">)</span></span>
<span><span class="va">resid_std</span> <span class="op">&lt;-</span> <span class="va">resid</span><span class="op">/</span><span class="va">rmse</span></span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">resid_std</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"TMR prédit"</span>,ylab<span class="op">=</span><span class="st">"Résidus standardisés"</span>,main<span class="op">=</span><span class="st">"Comportement des résidus standardisés"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">resid_std</span>, <span class="va">air_pollution</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-78-1.png" width="700"></p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rstudent_leverage</span> <span class="op">&lt;-</span> <span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_prep_rstudlev_data.html" class="external-link">ols_prep_rstudlev_data</a></span><span class="op">(</span><span class="va">reg_TMR_sel</span><span class="op">)</span></span>
<span><span class="va">rstudent</span> <span class="op">&lt;-</span> <span class="va">rstudent_leverage</span><span class="op">$</span><span class="va">levrstud</span><span class="op">$</span><span class="va">rstudent</span></span>
<span><span class="va">result_TMR_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">air_pollution</span>,<span class="va">rstudent</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">rstudent</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"TMR prédit"</span>,ylab<span class="op">=</span><span class="st">"RStudents"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">rstudent</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2.01</span>,<span class="fl">0</span>,<span class="fl">2.01</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-79-1.png" width="700"></p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leverage</span> <span class="op">&lt;-</span> <span class="va">rstudent_leverage</span><span class="op">$</span><span class="va">levrstud</span><span class="op">$</span><span class="va">leverage</span></span>
<span><span class="va">result_TMR_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_sel</span>,<span class="va">leverage</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">leverage</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"TMR prédit"</span>,ylab<span class="op">=</span><span class="st">"Leviers"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">leverage</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.16</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-80-1.png" width="700"></p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cookd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span></span>
<span>    <span class="op">{</span><span class="va">cookd</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="op">(</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">resid_std</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">leverage</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">result_TMR_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_sel</span>,<span class="va">cookd</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">cookd</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"TMR prédit"</span>,ylab<span class="op">=</span><span class="st">"D de Cook"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">cookd</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.0870</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-81-1.png" width="700"></p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_ville</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span></span>
<span><span class="va">dfb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">dfbetas</a></span><span class="op">(</span><span class="va">reg_TMR_sel</span><span class="op">)</span></span>
<span><span class="va">dfbetas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dfb</span><span class="op">)</span></span>
<span><span class="va">dfbetas_GE65</span> <span class="op">&lt;-</span> <span class="va">dfbetas</span><span class="op">$</span><span class="va">GE65</span></span>
<span><span class="va">result_TMR_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_sel</span>,<span class="va">dfbetas_GE65</span><span class="op">)</span></span>
<span><span class="va">dfbetas_l_pm2</span> <span class="op">&lt;-</span> <span class="va">dfbetas</span><span class="op">$</span><span class="va">l_pm2</span></span>
<span><span class="va">result_TMR_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_sel</span>,<span class="va">dfbetas_l_pm2</span><span class="op">)</span></span>
<span><span class="va">dfbetas_PERWH</span> <span class="op">&lt;-</span> <span class="va">dfbetas</span><span class="op">$</span><span class="va">PERWH</span></span>
<span><span class="va">result_TMR_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_sel</span>,<span class="va">dfbetas_PERWH</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">dfbetas_GE65</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"TMR prédit"</span>,ylab<span class="op">=</span><span class="st">"DFBetas pour GE65"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">dfbetas_GE65</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.2828</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-82-1.png" width="700"></p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">dfbetas_l_pm2</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"TMR prédit"</span>,ylab<span class="op">=</span><span class="st">"DFBetas pour l_pm2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">dfbetas_l_pm2</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.2828</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-82-2.png" width="700"></p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">dfbetas_PERWH</span>, type <span class="op">=</span> <span class="st">"n"</span>,xlab<span class="op">=</span><span class="st">"TMR prédit"</span>,ylab<span class="op">=</span><span class="st">"DFBetas pour PERWH"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">pred</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">dfbetas_PERWH</span>, <span class="va">result_TMR_sel</span><span class="op">$</span><span class="va">CITY</span>,col<span class="op">=</span><span class="st">'black'</span>,cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.2828</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-82-3.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="exercice-10-9-intervalles-de-confiance-et-de-prévision">Exercice 10.9 : Intervalles de confiance et de prévision<a class="anchor" aria-label="anchor" href="#exercice-10-9-intervalles-de-confiance-et-de-pr%C3%A9vision"></a>
</h2>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IC_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reg_TMR_sel</span>, interval<span class="op">=</span><span class="st">"confidence"</span><span class="op">)</span></span>
<span><span class="va">IC_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">IC_95</span><span class="op">)</span></span>
<span><span class="va">binf_IC_95</span> <span class="op">&lt;-</span> <span class="va">IC_95</span><span class="op">$</span><span class="va">lwr</span></span>
<span><span class="va">bsup_IC_95</span> <span class="op">&lt;-</span> <span class="va">IC_95</span><span class="op">$</span><span class="va">upr</span></span>
<span><span class="va">result_TMR_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">air_pollution</span>,<span class="va">binf_IC_95</span>,<span class="va">bsup_IC_95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">pred</span><span class="op">+</span><span class="va">binf_IC_95</span><span class="op">+</span><span class="va">bsup_IC_95</span><span class="op">~</span><span class="va">num_ville</span>,type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>,<span class="st">"l"</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">1</span>,cex<span class="op">=</span><span class="fl">2</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"green"</span>,<span class="st">"green"</span><span class="op">)</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">"TMR"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-83-1.png" width="700"></p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IP_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">reg_TMR_sel</span>, interval<span class="op">=</span><span class="st">"prediction"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in predict.lm(reg_TMR_sel, interval = "prediction"): predictions on current data refer to _future_ responses</span></span>
<span><span class="va">IP_95</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">IP_95</span><span class="op">)</span></span>
<span><span class="va">binf_IP_95</span> <span class="op">&lt;-</span> <span class="va">IP_95</span><span class="op">$</span><span class="va">lwr</span></span>
<span><span class="va">bsup_IP_95</span> <span class="op">&lt;-</span> <span class="va">IP_95</span><span class="op">$</span><span class="va">upr</span></span>
<span><span class="va">result_TMR_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">result_TMR_sel</span>,<span class="va">binf_IP_95</span>,<span class="va">bsup_IP_95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>oma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">air_pollution</span><span class="op">$</span><span class="va">TMR</span><span class="op">+</span><span class="va">pred</span><span class="op">+</span><span class="va">binf_IP_95</span><span class="op">+</span><span class="va">bsup_IP_95</span><span class="op">~</span><span class="va">num_ville</span>,type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>,<span class="st">"l"</span><span class="op">)</span>,lty<span class="op">=</span><span class="fl">1</span>,cex<span class="op">=</span><span class="fl">2</span>,lwd<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"red"</span>,<span class="st">"green"</span>,<span class="st">"green"</span><span class="op">)</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">"TMR"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-84-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="exercice-10-10-multicolinéarité">Exercice 10.10 : Multicolinéarité<a class="anchor" aria-label="anchor" href="#exercice-10-10-multicolin%C3%A9arit%C3%A9"></a>
</h2>
<p>Modèle avec <code>GE65</code>, <code>l_pm2</code> et
<code>PERWH</code></p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GE65</span> <span class="op">&lt;-</span> <span class="va">air_pollution</span><span class="op">$</span><span class="va">GE65</span></span>
<span><span class="va">l_pm2</span> <span class="op">&lt;-</span> <span class="va">air_pollution</span><span class="op">$</span><span class="va">l_pm2</span></span>
<span><span class="va">PERWH</span> <span class="op">&lt;-</span> <span class="va">air_pollution</span><span class="op">$</span><span class="va">PERWH</span></span>
<span><span class="va">predicteurs_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">GE65</span>,<span class="va">l_pm2</span>,<span class="va">PERWH</span><span class="op">)</span></span>
<span><span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html" class="external-link">ggpairs</a></span><span class="op">(</span><span class="va">predicteurs_sel</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-85-1.png" width="700"></p>
<p>Modèle avec <code>GE65</code>, <code>l_pm2</code> et
<code>NONPOOR</code></p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NONPOOR</span> <span class="op">&lt;-</span> <span class="va">air_pollution</span><span class="op">$</span><span class="va">NONPOOR</span></span>
<span><span class="va">predicteurs_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">GE65</span>,<span class="va">l_pm2</span>,<span class="va">NONPOOR</span><span class="op">)</span></span>
<span><span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html" class="external-link">ggpairs</a></span><span class="op">(</span><span class="va">predicteurs_sel</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-86-1.png" width="700"></p>
<p>Description des données : Consommation d’électricité</p>
<p>Consommation d’électricité journalière en France de l’année 2003</p>
<ul>
<li>Date : date</li>
<li>conso : consommation d’électricité en MWH</li>
<li>t : numéro du jour</li>
<li>nom_jour : nom du jour de la semaine</li>
<li>mois : nom du mois</li>
<li>temp : température en degrés Celsius</li>
<li>ejp : statut du jour EDF (spécial = 1 ; non spécial = 0)</li>
<li>ferie : statut du jour annuel (férié ou non)</li>
</ul>
<p>Lecture des données</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">conso_temp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exercice-10-12-analyse-descriptive">Exercice 10.12 : Analyse descriptive<a class="anchor" aria-label="anchor" href="#exercice-10-12-analyse-descriptive"></a>
</h2>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">conso_temp</span><span class="op">$</span><span class="va">temp</span>, <span class="va">conso_temp</span><span class="op">$</span><span class="va">conso</span>, xlab<span class="op">=</span><span class="st">"Température"</span>,ylab<span class="op">=</span><span class="st">"Consommation d'électricité"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-88-1.png" width="700"></p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">conso_temp</span><span class="op">$</span><span class="va">t</span>, <span class="va">conso_temp</span><span class="op">$</span><span class="va">conso</span>, type<span class="op">=</span><span class="st">"l"</span>,xlab<span class="op">=</span><span class="st">"Temps"</span>,ylab<span class="op">=</span><span class="st">"Consommation d'électricité"</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-89-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="exercice-10-13-plusieurs-petits-modèles">Exercice 10.13 : Plusieurs petits modèles<a class="anchor" aria-label="anchor" href="#exercice-10-13-plusieurs-petits-mod%C3%A8les"></a>
</h2>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.lm_conso_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="st">'conso~temp'</span>,data<span class="op">=</span><span class="va">conso_temp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.lm_conso_temp</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = "conso~temp", data = conso_temp)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -692370 -148563   14133  181002  457884 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  3096889      25829  119.90   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; temp          -46896       1741  -26.93   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 238800 on 363 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.6665, Adjusted R-squared:  0.6656 </span></span>
<span><span class="co">#&gt; F-statistic: 725.4 on 1 and 363 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.lm_conso_nom_jour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="st">'conso~nom_jour'</span>,data<span class="op">=</span><span class="va">conso_temp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.lm_conso_nom_jour</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = "conso~nom_jour", data = conso_temp)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -770678 -288794 -170887  334431 1004436 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)       2165591      53080  40.799  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourJeudi      429619      75066   5.723 2.21e-08 ***</span></span>
<span><span class="co">#&gt; nom_jourLundi      359886      75066   4.794 2.40e-06 ***</span></span>
<span><span class="co">#&gt; nom_jourMardi      442490      75066   5.895 8.68e-09 ***</span></span>
<span><span class="co">#&gt; nom_jourMercredi   454991      74711   6.090 2.91e-09 ***</span></span>
<span><span class="co">#&gt; nom_jourSamedi     155504      75066   2.072    0.039 *  </span></span>
<span><span class="co">#&gt; nom_jourVendredi   412957      75066   5.501 7.19e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 382800 on 358 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.1552, Adjusted R-squared:  0.141 </span></span>
<span><span class="co">#&gt; F-statistic: 10.96 on 6 and 358 DF,  p-value: 3.257e-11</span></span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.lm_conso_mois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="st">'conso~mois'</span>,data<span class="op">=</span><span class="va">conso_temp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.lm_conso_mois</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = "conso~mois", data = conso_temp)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -903710 -171027   46853  158783  511053 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)    2032302      42394  47.938  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisAvril       392288      60452   6.489 2.92e-10 ***</span></span>
<span><span class="co">#&gt; moisDécembre    963815      59954  16.076  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisFévrier     954286      61539  15.507  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisJanvier     955814      59954  15.942  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisJuillet     183273      59954   3.057  0.00241 ** </span></span>
<span><span class="co">#&gt; moisJuin        153228      60452   2.535  0.01169 *  </span></span>
<span><span class="co">#&gt; moisMai         111377      59954   1.858  0.06404 .  </span></span>
<span><span class="co">#&gt; moisMars        420908      59954   7.020 1.14e-11 ***</span></span>
<span><span class="co">#&gt; moisNovembre    701163      60452  11.599  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisOctobre     502472      59954   8.381 1.26e-15 ***</span></span>
<span><span class="co">#&gt; moisSeptembre   166700      60452   2.758  0.00613 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 236000 on 353 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.6832, Adjusted R-squared:  0.6733 </span></span>
<span><span class="co">#&gt; F-statistic: 69.21 on 11 and 353 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.lm_conso_ejp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="st">'conso~ejp'</span>,data<span class="op">=</span><span class="va">conso_temp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.lm_conso_ejp</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = "conso~ejp", data = conso_temp)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -728827 -234856  -73797  274354  947544 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  2441670      20398 119.701   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ejp           678776      77941   8.709   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 376100 on 363 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.1728, Adjusted R-squared:  0.1705 </span></span>
<span><span class="co">#&gt; F-statistic: 75.84 on 1 and 363 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.lm_conso_ferie</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="st">'conso~ferie'</span>,data<span class="op">=</span><span class="va">conso_temp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.lm_conso_ferie</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = "conso~ferie", data = conso_temp)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -788625 -257112 -113856  321808  970137 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  2501468      21609 115.762  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ferieoui     -441526     124474  -3.547 0.000441 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 406600 on 363 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.0335, Adjusted R-squared:  0.03084 </span></span>
<span><span class="co">#&gt; F-statistic: 12.58 on 1 and 363 DF,  p-value: 0.0004405</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exercice-10-14-modèle-complet">Exercice 10.14 : Modèle complet<a class="anchor" aria-label="anchor" href="#exercice-10-14-mod%C3%A8le-complet"></a>
</h2>
<p>Modèle complet</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.lm_conso_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="st">'conso~temp+nom_jour+mois+ejp+ferie'</span>,data<span class="op">=</span><span class="va">conso_temp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.lm_conso_all</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = "conso~temp+nom_jour+mois+ejp+ferie", data = conso_temp)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -451348  -63336    -503   65596  277071 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)       2598970      55304  46.994  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; temp               -36387       2108 -17.260  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourJeudi      448914      21979  20.425  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourLundi      375634      22036  17.047  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourMardi      434728      21831  19.913  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourMercredi   436470      21719  20.096  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourSamedi     162655      21710   7.492 5.77e-13 ***</span></span>
<span><span class="co">#&gt; nom_jourVendredi   407251      22009  18.504  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisAvril          -56350      37699  -1.495 0.135906    </span></span>
<span><span class="co">#&gt; moisDécembre       287132      46564   6.166 1.96e-09 ***</span></span>
<span><span class="co">#&gt; moisFévrier        206940      49032   4.221 3.12e-05 ***</span></span>
<span><span class="co">#&gt; moisJanvier        192104      49439   3.886 0.000122 ***</span></span>
<span><span class="co">#&gt; moisJuillet         74649      28546   2.615 0.009315 ** </span></span>
<span><span class="co">#&gt; moisJuin            66417      28755   2.310 0.021493 *  </span></span>
<span><span class="co">#&gt; moisMai           -182620      33408  -5.466 8.84e-08 ***</span></span>
<span><span class="co">#&gt; moisMars           -90910      39555  -2.298 0.022143 *  </span></span>
<span><span class="co">#&gt; moisNovembre       196805      41513   4.741 3.12e-06 ***</span></span>
<span><span class="co">#&gt; moisOctobre         -2434      39040  -0.062 0.950330    </span></span>
<span><span class="co">#&gt; moisSeptembre     -105467      31583  -3.339 0.000932 ***</span></span>
<span><span class="co">#&gt; ejp                 37347      27235   1.371 0.171173    </span></span>
<span><span class="co">#&gt; ferieoui          -426169      34816 -12.241  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 110600 on 344 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.9322, Adjusted R-squared:  0.9283 </span></span>
<span><span class="co">#&gt; F-statistic: 236.5 on 20 and 344 DF,  p-value: &lt; 2.2e-16</span></span>
<span><span class="va">SCT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">conso_temp</span><span class="op">$</span><span class="va">conso</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">conso_temp</span><span class="op">$</span><span class="va">conso</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">res.lm_conso_all</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">SCR_all</span> <span class="op">&lt;-</span> <span class="fl">364</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span></span>
<span><span class="va">SCE_all</span> <span class="op">&lt;-</span> <span class="va">SCT</span><span class="op">-</span><span class="va">SCR_all</span></span></code></pre></div>
<p>Calcul de l’apport de chaque variable du modèle à l’aide du <span class="math inline">\(F\)</span> partiel</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">f_partiel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">nu_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">nu_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Modèle sans temp</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.lm_conso_all_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="st">'conso~nom_jour+mois+ejp+ferie'</span>,data<span class="op">=</span><span class="va">conso_temp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.lm_conso_all_temp</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = "conso~nom_jour+mois+ejp+ferie", data = conso_temp)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -702695  -86287    7982   64969  549209 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)       1741637      33169  52.508  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourJeudi      445230      29979  14.852  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourLundi      360841      30035  12.014  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourMardi      432122      29778  14.512  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourMercredi   429988      29621  14.516  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourSamedi     164855      29613   5.567 5.21e-08 ***</span></span>
<span><span class="co">#&gt; nom_jourVendredi   395312      30006  13.174  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisAvril          372535      38672   9.633  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisDécembre       926320      38502  24.059  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisFévrier        879036      40644  21.628  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisJanvier        879180      39993  21.983  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisJuillet        159171      38361   4.149 4.20e-05 ***</span></span>
<span><span class="co">#&gt; moisJuin           150183      38660   3.885 0.000123 ***</span></span>
<span><span class="co">#&gt; moisMai            126884      38449   3.300 0.001068 ** </span></span>
<span><span class="co">#&gt; moisMars           385598      38639   9.979  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisNovembre       720084      38682  18.615  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisOctobre        464623      38385  12.104  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisSeptembre      133819      38708   3.457 0.000614 ***</span></span>
<span><span class="co">#&gt; ejp                166527      35719   4.662 4.48e-06 ***</span></span>
<span><span class="co">#&gt; ferieoui          -462962      47401  -9.767  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 150900 on 345 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.8735, Adjusted R-squared:  0.8665 </span></span>
<span><span class="co">#&gt; F-statistic: 125.4 on 19 and 345 DF,  p-value: &lt; 2.2e-16</span></span>
<span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">res.lm_conso_all_temp</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">SCR_temp</span> <span class="op">&lt;-</span><span class="fl">364</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span></span>
<span><span class="va">SCE_temp</span> <span class="op">&lt;-</span> <span class="va">SCT</span><span class="op">-</span><span class="va">SCR_temp</span></span>
<span><span class="va">f_temp</span><span class="op">=</span><span class="op">(</span><span class="op">(</span><span class="va">SCE_all</span><span class="op">-</span><span class="va">SCE_temp</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">SCR_all</span><span class="op">/</span><span class="fl">344</span><span class="op">)</span></span>
<span><span class="va">p_val_temp</span> <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf</a></span><span class="op">(</span><span class="va">f_temp</span>,<span class="fl">1</span>,<span class="fl">344</span><span class="op">)</span></span>
<span><span class="va">variable</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"temp"</span></span>
<span><span class="va">f_partiel</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">f_temp</span></span>
<span><span class="va">p_value</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p_val_temp</span></span>
<span><span class="va">nu_1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">nu_2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">344</span></span></code></pre></div>
<p>Modèle sans <code>nom_jour</code></p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.lm_conso_all_nom_jour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="st">'conso~temp+mois+ejp+ferie'</span>,data<span class="op">=</span><span class="va">conso_temp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.lm_conso_all_nom_jour</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = "conso~temp+mois+ejp+ferie", data = conso_temp)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -630398 -113728   35907  142429  363782 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)    2865800      94502  30.325  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; temp            -34648       3704  -9.355  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisAvril       -15554      66250  -0.235  0.81452    </span></span>
<span><span class="co">#&gt; moisDécembre    327835      81827   4.006 7.53e-05 ***</span></span>
<span><span class="co">#&gt; moisFévrier     220265      86242   2.554  0.01107 *  </span></span>
<span><span class="co">#&gt; moisJanvier     209386      86960   2.408  0.01656 *  </span></span>
<span><span class="co">#&gt; moisJuillet     102883      50178   2.050  0.04107 *  </span></span>
<span><span class="co">#&gt; moisJuin         74196      50566   1.467  0.14319    </span></span>
<span><span class="co">#&gt; moisMai        -158730      58752  -2.702  0.00723 ** </span></span>
<span><span class="co">#&gt; moisMars        -82017      69554  -1.179  0.23912    </span></span>
<span><span class="co">#&gt; moisNovembre    215735      73000   2.955  0.00334 ** </span></span>
<span><span class="co">#&gt; moisOctobre      45864      68580   0.669  0.50408    </span></span>
<span><span class="co">#&gt; moisSeptembre   -72995      55491  -1.315  0.18923    </span></span>
<span><span class="co">#&gt; ejp             163930      46797   3.503  0.00052 ***</span></span>
<span><span class="co">#&gt; ferieoui       -344641      60567  -5.690 2.68e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 194600 on 350 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.7864, Adjusted R-squared:  0.7779 </span></span>
<span><span class="co">#&gt; F-statistic: 92.06 on 14 and 350 DF,  p-value: &lt; 2.2e-16</span></span>
<span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">res.lm_conso_all_nom_jour</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">SCR_nom_jour</span> <span class="op">&lt;-</span><span class="fl">364</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span></span>
<span><span class="va">SCE_nom_jour</span> <span class="op">&lt;-</span> <span class="va">SCT</span><span class="op">-</span><span class="va">SCR_nom_jour</span></span>
<span><span class="va">f_nom_jour</span><span class="op">=</span><span class="op">(</span><span class="op">(</span><span class="va">SCE_all</span><span class="op">-</span><span class="va">SCE_nom_jour</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">SCR_all</span><span class="op">/</span><span class="fl">344</span><span class="op">)</span></span>
<span><span class="va">p_val_nom_jour</span> <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf</a></span><span class="op">(</span><span class="va">f_nom_jour</span>,<span class="fl">6</span>,<span class="fl">344</span><span class="op">)</span></span>
<span><span class="va">variable</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"nom_jour"</span></span>
<span><span class="va">f_partiel</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">f_nom_jour</span></span>
<span><span class="va">p_value</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p_val_nom_jour</span></span>
<span><span class="va">nu_1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">nu_2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">344</span></span></code></pre></div>
<p>Modèle sans <code>mois</code></p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.lm_conso_all_mois</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="st">'conso~temp+nom_jour+ejp+ferie'</span>,data<span class="op">=</span><span class="va">conso_temp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.lm_conso_all_mois</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = "conso~temp+nom_jour+ejp+ferie", data = conso_temp)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -409421 -130397   -2182  132234  366626 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)       2762583      29064  95.052  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; temp               -45087       1327 -33.970  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourJeudi      441220      33115  13.324  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourLundi      370313      33180  11.161  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourMardi      429878      32877  13.076  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourMercredi   434874      32713  13.293  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourSamedi     156265      32753   4.771 2.68e-06 ***</span></span>
<span><span class="co">#&gt; nom_jourVendredi   397181      33141  11.984  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ejp                 65601      38437   1.707   0.0888 .  </span></span>
<span><span class="co">#&gt; ferieoui          -415458      51776  -8.024 1.51e-14 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 166900 on 355 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.8407, Adjusted R-squared:  0.8366 </span></span>
<span><span class="co">#&gt; F-statistic: 208.1 on 9 and 355 DF,  p-value: &lt; 2.2e-16</span></span>
<span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">res.lm_conso_all_mois</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">SCR_mois</span> <span class="op">&lt;-</span><span class="fl">364</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span></span>
<span><span class="va">SCE_mois</span> <span class="op">&lt;-</span> <span class="va">SCT</span><span class="op">-</span><span class="va">SCR_mois</span></span>
<span><span class="va">f_mois</span><span class="op">=</span><span class="op">(</span><span class="op">(</span><span class="va">SCE_all</span><span class="op">-</span><span class="va">SCE_mois</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">11</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">SCR_all</span><span class="op">/</span><span class="fl">344</span><span class="op">)</span></span>
<span><span class="va">p_val_mois</span> <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf</a></span><span class="op">(</span><span class="va">f_mois</span>,<span class="fl">11</span>,<span class="fl">344</span><span class="op">)</span></span>
<span><span class="va">variable</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"mois"</span></span>
<span><span class="va">f_partiel</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">f_mois</span></span>
<span><span class="va">p_value</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p_val_mois</span></span>
<span><span class="va">nu_1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">11</span></span>
<span><span class="va">nu_2</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">344</span></span></code></pre></div>
<p>Modèle sans <code>ejp</code></p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.lm_conso_all_ejp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="st">'conso~temp+nom_jour+mois+ferie'</span>,data<span class="op">=</span><span class="va">conso_temp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.lm_conso_all_ejp</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = "conso~temp+nom_jour+mois+ferie", data = conso_temp)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -457304  -63748    -802   65726  268560 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)       2615465      54049  48.391  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; temp               -37181       2030 -18.320  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourJeudi      451690      21913  20.613  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourLundi      380006      21832  17.406  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourMardi      437513      21764  20.103  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourMercredi   439124      21660  20.274  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourSamedi     162645      21738   7.482 6.13e-13 ***</span></span>
<span><span class="co">#&gt; nom_jourVendredi   412078      21753  18.943  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisAvril          -65809      37110  -1.773 0.077054 .  </span></span>
<span><span class="co">#&gt; moisDécembre       276367      45956   6.014 4.62e-09 ***</span></span>
<span><span class="co">#&gt; moisFévrier        201983      48961   4.125 4.64e-05 ***</span></span>
<span><span class="co">#&gt; moisJanvier        188074      49415   3.806 0.000167 ***</span></span>
<span><span class="co">#&gt; moisJuillet         72696      28547   2.547 0.011313 *  </span></span>
<span><span class="co">#&gt; moisJuin            64533      28759   2.244 0.025470 *  </span></span>
<span><span class="co">#&gt; moisMai           -189332      33090  -5.722 2.29e-08 ***</span></span>
<span><span class="co">#&gt; moisMars           -96908      39362  -2.462 0.014307 *  </span></span>
<span><span class="co">#&gt; moisNovembre       185527      40742   4.554 7.32e-06 ***</span></span>
<span><span class="co">#&gt; moisOctobre        -12864      38341  -0.336 0.737432    </span></span>
<span><span class="co">#&gt; moisSeptembre     -110907      31373  -3.535 0.000463 ***</span></span>
<span><span class="co">#&gt; ferieoui          -427425      34848 -12.265  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 110800 on 345 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.9318, Adjusted R-squared:  0.9281 </span></span>
<span><span class="co">#&gt; F-statistic: 248.2 on 19 and 345 DF,  p-value: &lt; 2.2e-16</span></span>
<span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">res.lm_conso_all_ejp</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">SCR_ejp</span> <span class="op">&lt;-</span><span class="fl">364</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span></span>
<span><span class="va">SCE_ejp</span> <span class="op">&lt;-</span> <span class="va">SCT</span><span class="op">-</span><span class="va">SCR_ejp</span></span>
<span><span class="va">f_ejp</span><span class="op">=</span><span class="op">(</span><span class="op">(</span><span class="va">SCE_all</span><span class="op">-</span><span class="va">SCE_ejp</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">SCR_all</span><span class="op">/</span><span class="fl">344</span><span class="op">)</span></span>
<span><span class="va">p_val_ejp</span> <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf</a></span><span class="op">(</span><span class="va">f_ejp</span>,<span class="fl">1</span>,<span class="fl">344</span><span class="op">)</span></span>
<span><span class="va">variable</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"ejp"</span></span>
<span><span class="va">f_partiel</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">f_ejp</span></span>
<span><span class="va">p_value</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p_val_ejp</span></span>
<span><span class="va">nu_1</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">nu_2</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">344</span></span></code></pre></div>
<p>Modèle sans <code>ferie</code></p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.lm_conso_all_ferie</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="st">'conso~temp+nom_jour+mois+ejp'</span>,data<span class="op">=</span><span class="va">conso_temp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.lm_conso_all_ferie</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = "conso~temp+nom_jour+mois+ejp", data = conso_temp)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -772831  -64226    8971   76576  270685 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)       2635541      66070  39.890  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; temp               -37967       2518 -15.081  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourJeudi      415540      26093  15.926  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourLundi      349569      26240  13.322  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourMardi      425238      26102  16.291  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourMercredi   427407      25969  16.458  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourSamedi     154906      25963   5.966 6.01e-09 ***</span></span>
<span><span class="co">#&gt; nom_jourVendredi   397921      26316  15.121  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisAvril          -74946      45067  -1.663  0.09722 .  </span></span>
<span><span class="co">#&gt; moisDécembre       258894      55641   4.653 4.67e-06 ***</span></span>
<span><span class="co">#&gt; moisFévrier        188116      58633   3.208  0.00146 ** </span></span>
<span><span class="co">#&gt; moisJanvier        158767      59060   2.688  0.00753 ** </span></span>
<span><span class="co">#&gt; moisJuillet         72107      34152   2.111  0.03546 *  </span></span>
<span><span class="co">#&gt; moisJuin            63065      34401   1.833  0.06763 .  </span></span>
<span><span class="co">#&gt; moisMai           -222369      39780  -5.590 4.62e-08 ***</span></span>
<span><span class="co">#&gt; moisMars           -99217      47317  -2.097  0.03673 *  </span></span>
<span><span class="co">#&gt; moisNovembre       159581      49533   3.222  0.00140 ** </span></span>
<span><span class="co">#&gt; moisOctobre         -7882      46705  -0.169  0.86609    </span></span>
<span><span class="co">#&gt; moisSeptembre     -101100      37784  -2.676  0.00781 ** </span></span>
<span><span class="co">#&gt; ejp                 46121      32573   1.416  0.15770    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 132300 on 345 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.9027, Adjusted R-squared:  0.8973 </span></span>
<span><span class="co">#&gt; F-statistic: 168.4 on 19 and 345 DF,  p-value: &lt; 2.2e-16</span></span>
<span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">res.lm_conso_all_ferie</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">SCR_ferie</span> <span class="op">&lt;-</span><span class="fl">364</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span></span>
<span><span class="va">SCE_ferie</span> <span class="op">&lt;-</span> <span class="va">SCT</span><span class="op">-</span><span class="va">SCR_ferie</span></span>
<span><span class="va">f_ferie</span><span class="op">=</span><span class="op">(</span><span class="op">(</span><span class="va">SCE_all</span><span class="op">-</span><span class="va">SCE_ferie</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">SCR_all</span><span class="op">/</span><span class="fl">344</span><span class="op">)</span></span>
<span><span class="va">p_val_ferie</span> <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf</a></span><span class="op">(</span><span class="va">f_ferie</span>,<span class="fl">1</span>,<span class="fl">344</span><span class="op">)</span></span>
<span><span class="va">variable</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"ferie"</span></span>
<span><span class="va">f_partiel</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">f_ferie</span></span>
<span><span class="va">p_value</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">p_val_ferie</span></span>
<span><span class="va">nu_1</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">nu_2</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">344</span></span>
<span></span>
<span><span class="va">f_partiel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">f_partiel</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">p_value</span>,<span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tab_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">variable</span>,<span class="va">f_partiel</span>,<span class="va">nu_1</span>,<span class="va">nu_2</span>,<span class="va">p_value</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res.lm_conso_all</span><span class="op">)</span></span>
<span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">conso_temp</span><span class="op">$</span><span class="va">conso</span><span class="op">+</span><span class="va">pred</span><span class="op">~</span><span class="va">conso_temp</span><span class="op">$</span><span class="va">t</span>,type<span class="op">=</span><span class="st">"l"</span>,xlab<span class="op">=</span><span class="st">"Temps"</span>,ylab<span class="op">=</span><span class="st">"Consommation d'électricité"</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-101-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="exercice-10-15-un-modèle-à-la-main">Exercice 10.15 : Un modèle « à la main »<a class="anchor" aria-label="anchor" href="#exercice-10-15-un-mod%C3%A8le-%C3%A0-la-main"></a>
</h2>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res.lm_conso_all_ejp</span><span class="op">)</span></span>
<span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">conso_temp</span><span class="op">$</span><span class="va">conso</span><span class="op">+</span><span class="va">pred</span><span class="op">~</span><span class="va">conso_temp</span><span class="op">$</span><span class="va">t</span>,type<span class="op">=</span><span class="st">"l"</span>,xlab<span class="op">=</span><span class="st">"Temps"</span>,ylab<span class="op">=</span><span class="st">"Consommation d'électricité"</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-102-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="exercice-10-16-amélioration-du-modèle">Exercice 10.16 : Amélioration du modèle<a class="anchor" aria-label="anchor" href="#exercice-10-16-am%C3%A9lioration-du-mod%C3%A8le"></a>
</h2>
<p>Création de la variable catégorielle pour la variable température</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">365</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">365</span><span class="op">)</span></span>
<span>    <span class="op">{</span><span class="kw">if</span> <span class="op">(</span><span class="va">conso_temp</span><span class="op">$</span><span class="va">temp</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">15</span><span class="op">)</span> <span class="op">{</span><span class="va">temp_cat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="st">"&lt; 15°C"</span><span class="op">}</span></span>
<span>        <span class="kw">else</span> <span class="op">{</span><span class="va">temp_cat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">=</span><span class="st">"&gt;= 15°C"</span><span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span><span class="va">conso_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">conso_temp</span>,<span class="va">temp_cat</span><span class="op">)</span></span></code></pre></div>
<p>Modèle avec interaction</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.lm_conso_interaction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="st">'conso~temp_cat+temp_cat:temp+nom_jour+mois+ferie'</span>,data<span class="op">=</span><span class="va">conso_temp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.lm_conso_interaction</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = "conso~temp_cat+temp_cat:temp+nom_jour+mois+ferie", </span></span>
<span><span class="co">#&gt;     data = conso_temp)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -310536  -44343    5330   50004  219595 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                      Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)           2507322      42119  59.529  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; temp_cat&gt;= 15°C       -801107      62550 -12.807  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourJeudi          449495      16904  26.592  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourLundi          381074      16782  22.708  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourMardi          440276      16724  26.325  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourMercredi       438833      16657  26.345  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourSamedi         161271      16713   9.650  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourVendredi       407964      16749  24.357  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisAvril              225840      34140   6.615 1.43e-10 ***</span></span>
<span><span class="co">#&gt; moisDécembre           491569      38135  12.890  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisFévrier            387779      39608   9.790  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisJanvier            364928      39757   9.179  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisJuillet            161472      22902   7.050 9.87e-12 ***</span></span>
<span><span class="co">#&gt; moisJuin               152211      23042   6.606 1.51e-10 ***</span></span>
<span><span class="co">#&gt; moisMai                118947      32258   3.687 0.000263 ***</span></span>
<span><span class="co">#&gt; moisMars               197024      36149   5.450 9.63e-08 ***</span></span>
<span><span class="co">#&gt; moisNovembre           465714      36539  12.746  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisOctobre            273485      34966   7.821 6.51e-14 ***</span></span>
<span><span class="co">#&gt; moisSeptembre          140706      29777   4.725 3.36e-06 ***</span></span>
<span><span class="co">#&gt; ferieoui              -430840      26782 -16.087  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; temp_cat&lt; 15°C:temp    -55429       2003 -27.679  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; temp_cat&gt;= 15°C:temp     1162       3254   0.357 0.721318    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 85100 on 343 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:   0.96,  Adjusted R-squared:  0.9575 </span></span>
<span><span class="co">#&gt; F-statistic: 391.8 on 21 and 343 DF,  p-value: &lt; 2.2e-16</span></span>
<span><span class="va">SCT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">conso_temp</span><span class="op">$</span><span class="va">conso</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">conso_temp</span><span class="op">$</span><span class="va">conso</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">res.lm_conso_interaction</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">SCR_interaction</span> <span class="op">&lt;-</span> <span class="fl">364</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span></span>
<span><span class="va">SCE_interaction</span> <span class="op">&lt;-</span> <span class="va">SCT</span><span class="op">-</span><span class="va">SCR_interaction</span></span></code></pre></div>
<p>Modèle sans interaction</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.lm_conso_sans_inter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="st">'conso~temp+nom_jour+mois+ferie'</span>,data<span class="op">=</span><span class="va">conso_temp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res.lm_conso_sans_inter</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = "conso~temp+nom_jour+mois+ferie", data = conso_temp)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -457304  -63748    -802   65726  268560 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)       2615465      54049  48.391  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; temp               -37181       2030 -18.320  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourJeudi      451690      21913  20.613  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourLundi      380006      21832  17.406  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourMardi      437513      21764  20.103  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourMercredi   439124      21660  20.274  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; nom_jourSamedi     162645      21738   7.482 6.13e-13 ***</span></span>
<span><span class="co">#&gt; nom_jourVendredi   412078      21753  18.943  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; moisAvril          -65809      37110  -1.773 0.077054 .  </span></span>
<span><span class="co">#&gt; moisDécembre       276367      45956   6.014 4.62e-09 ***</span></span>
<span><span class="co">#&gt; moisFévrier        201983      48961   4.125 4.64e-05 ***</span></span>
<span><span class="co">#&gt; moisJanvier        188074      49415   3.806 0.000167 ***</span></span>
<span><span class="co">#&gt; moisJuillet         72696      28547   2.547 0.011313 *  </span></span>
<span><span class="co">#&gt; moisJuin            64533      28759   2.244 0.025470 *  </span></span>
<span><span class="co">#&gt; moisMai           -189332      33090  -5.722 2.29e-08 ***</span></span>
<span><span class="co">#&gt; moisMars           -96908      39362  -2.462 0.014307 *  </span></span>
<span><span class="co">#&gt; moisNovembre       185527      40742   4.554 7.32e-06 ***</span></span>
<span><span class="co">#&gt; moisOctobre        -12864      38341  -0.336 0.737432    </span></span>
<span><span class="co">#&gt; moisSeptembre     -110907      31373  -3.535 0.000463 ***</span></span>
<span><span class="co">#&gt; ferieoui          -427425      34848 -12.265  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 110800 on 345 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.9318, Adjusted R-squared:  0.9281 </span></span>
<span><span class="co">#&gt; F-statistic: 248.2 on 19 and 345 DF,  p-value: &lt; 2.2e-16</span></span>
<span><span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">res.lm_conso_sans_inter</span><span class="op">$</span><span class="va">residuals</span></span>
<span><span class="va">SCR_sans_inter</span> <span class="op">&lt;-</span> <span class="fl">364</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">resid</span><span class="op">)</span></span>
<span><span class="va">SCE_sans_inter</span> <span class="op">&lt;-</span> <span class="va">SCT</span><span class="op">-</span><span class="va">SCR_sans_inter</span></span>
<span><span class="va">f_inter</span><span class="op">=</span><span class="op">(</span><span class="op">(</span><span class="va">SCE_interaction</span><span class="op">-</span><span class="va">SCE_sans_inter</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">SCR_interaction</span><span class="op">/</span><span class="fl">344</span><span class="op">)</span></span>
<span><span class="va">p_val_inter</span> <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf</a></span><span class="op">(</span><span class="va">f_inter</span>,<span class="fl">2</span>,<span class="fl">344</span><span class="op">)</span></span>
<span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"interaction"</span></span>
<span><span class="va">f_partiel</span> <span class="op">&lt;-</span> <span class="va">f_inter</span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="va">p_val_inter</span></span>
<span><span class="va">nu_1</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">nu_2</span> <span class="op">&lt;-</span> <span class="fl">344</span></span>
<span></span>
<span><span class="va">tab_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">variable</span>,<span class="va">f_partiel</span>,<span class="va">nu_1</span>,<span class="va">nu_2</span>,<span class="va">p_value</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res.lm_conso_interaction</span><span class="op">)</span></span>
<span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span><span class="va">conso_temp</span><span class="op">$</span><span class="va">conso</span><span class="op">+</span><span class="va">pred</span><span class="op">~</span><span class="va">conso_temp</span><span class="op">$</span><span class="va">t</span>,type<span class="op">=</span><span class="st">"l"</span>,xlab<span class="op">=</span><span class="st">"Temps"</span>,ylab<span class="op">=</span><span class="st">"Consommation d'électricité"</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="CodeChap10_files/figure-html/unnamed-chunk-105-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Frederic Bertrand, Myriam Maumy-Bertrand.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
